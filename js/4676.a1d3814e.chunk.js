/*! For license information please see 4676.a1d3814e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[4676],{14906:function(e,r,t){t.d(r,{k:function(){return n}});var n={GetAppliedLabelError:"GetAppliedLabelError",GetDlpPolicyTipError:"GetDlpPolicyTipError",GetIrmCapabilitiesError:"GetIrmCapabilitiesError",GetLabelsError:"GetLabelsError",GetPolicySettingsError:"GetPolicySettingsError",GetWatermarkingError:"GetWatermarkingError",InvalidLabelId:"InvalidLabelId",InvalidResolvedUrl:"InvalidResolvedUrl",InvalidTenantId:"InvalidTenantId",RemoveLabelError:"RemoveLabelError",SetLabelError:"SetLabelError",EnforceInformationProtectionError:"EnforceInformationProtectionError",ConfigureMandatoryLabelError:"ConfigureMandatoryLabelError",ConfigureIrmCapabilitiesError:"ConfigureIrmCapabilitiesError"}},80395:function(e,r,t){t.d(r,{L:function(){return n}});var n={RefreshTimerTriggered:"RefreshTimerTriggered",MandatoryLabelHandlerSetReadOnly:"MandatoryLabelHandlerSetReadOnly",MandatoryLabelHandlerResetReadOnly:"MandatoryLabelHandlerResetReadOnly",InformationProtectionServiceDisposed:"InformationProtectionServiceDisposed"}},99427:function(e,r,t){t.d(r,{$:function(){return n}});var n={GetAppliedLabel:"GetAppliedLabel",GetIsProtectionEnabled:"GetIsProtectionEnabled",GetIrmCapabilities:"GetIrmCapabilities",GetWatermarking:"GetWatermarking",SetLabel:"SetLabel",RemoveLabel:"RemoveLabel",GetDlpPolicyTip:"GetDlpPolicyTip",ProcessPolicySettings:"ProcessPolicySettings",EnforceInformationProtection:"EnforceInformationProtection",EnforceMandatoryLabelExperience:"EnforceMandatoryLabelExperience"}},48001:function(e,r,t){t.d(r,{eC:function(){return zr},zU:function(){return Vr},Nm:function(){return Wr},HJ:function(){return Jr},tS:function(){return qr}});var n=t(74165),a=t(1413),o=t(15861),i=t(42552),c=t(12338),s=t(17736),u=t(15671),l=t(43144),d=t(63658),v=t(29930),f=t(29477),p="1",h="fluid",m="s",g="d",y="f",k="c",w="a",b="p",Z="v",I="x";function E(e){var r=new URL(e.siteUrl),t=encodeURIComponent(r.pathname),n=encodeURIComponent(e.driveId),a=encodeURIComponent(e.itemId),o=encodeURIComponent(e.dataStorePath),i="".concat(m,"=").concat(t,"&").concat(g,"=").concat(n,"&").concat(y,"=").concat(a,"&").concat(k,"=").concat(o,"&").concat(h,"=").concat(p);return e.appName&&(i+="&".concat(w,"=").concat(encodeURIComponent(e.appName))),e.containerPackageName&&(i+="&".concat(b,"=").concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(i+="&".concat(Z,"=").concat(encodeURIComponent(e.fileVersion))),e.context&&(i+="&".concat(I,"=").concat(encodeURIComponent(e.context))),(0,v.d3)(i)}var C,S,P="nav";function x(e,r){var t=E(r);e.searchParams.set(P,t)}function N(e){var r=e.searchParams.get(P);if(r)return function(e,r){var t,n,a,o,i=new URLSearchParams((0,v.fW)(e));if("1"===i.get(h)){var c=i.get(m),s=i.get(g),u=i.get(y),l=i.get(k),d=null!==(t=i.get(w))&&void 0!==t?t:void 0,f=null!==(n=i.get(b))&&void 0!==n?n:void 0,p=null!==(a=i.get(Z))&&void 0!==a?a:void 0,E=null!==(o=i.get(I))&&void 0!==o?o:void 0;if(c&&s&&u&&null!==l){var C;try{C=new URL(c,r)}catch(S){}if(C)return{siteUrl:C.href,driveId:s,itemId:u,dataStorePath:l,appName:d,containerPackageName:f,fileVersion:p,context:E}}}}(r,e.origin.toLowerCase()===f.U?f._:e.origin)}function R(e){var r="".concat(e.siteUrl,"?driveId=").concat(encodeURIComponent(e.driveId),"&itemId=").concat(encodeURIComponent(e.itemId),"&path=").concat(encodeURIComponent(e.dataStorePath));return e.containerPackageName&&(r+="&containerPackageName=".concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(r+="&fileVersion=".concat(encodeURIComponent(e.fileVersion))),r}!function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(C||(C={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(S||(S={}));var T,O=t(29439),L=t(27186);!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(T||(T={}));var U,j,A,M=t(21850);!function(e){e.csl="csl"}(U||(U={})),function(e){e.organization="organization",e.users="users",e.anonymous="anonymous",e.default="default"}(j||(j={})),function(e){e.view="view",e.edit="edit"}(A||(A={}));var F=t(60136),G=t(29388),D=t(28664),_=t(92810),V=function(e){return"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)&&"function"===typeof(null===e||void 0===e?void 0:e.addTelemetryProperties)},z=function(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId)};var H=function(e){return null!==e&&!Array.isArray(e)&&"object"===typeof e};function W(e,r){var t={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(H(e)){var n=e.errorType,a=e.stack,o=e.name;if("string"===typeof n&&(t.errorType=n),"string"===typeof a){var i="string"===typeof o?o:void 0;t.stack=function(e,t){if(!r)return e;var n=e.split("\n");return n.shift(),void 0!==t&&n.unshift(t),n.join("\n")}(a,i)}}return t}var q,J=function(e){return"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)};function B(){return function(){var e=new Error("<<generated stack>>");if(void 0===q&&(q=void 0!==e.stack),q)return e;try{throw e}catch(r){return r}}().stack}function X(e,r){var t=W(e,!1),n=t.message,a=t.stack,o=r(n);return void 0!==a&&Y(o,a),function(e){if(re.typeCheck(e))return e.errorType===te&&1===e.getTelemetryProperties().untrustedOrigin;return!function(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&V(e)}(e)}(e)&&o.addTelemetryProperties({untrustedOrigin:1}),z(e)&&(o.overwriteErrorInstanceId(e.errorInstanceId),o.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),J(e)&&o.addTelemetryProperties(e.getTelemetryProperties()),o}function Y(e,r){try{Object.assign(e,{stack:r})}catch(t){e.addTelemetryProperties({stack2:r})}}function K(e){var r;return"string"===typeof(null===(r=e)||void 0===r?void 0:r.tag)}function $(e,r){return Array.isArray(e)&&e.every((function(e){return Q(e)}))?JSON.stringify(e):Q(e)?e:(console.error("UnSupported Format of Logging Error Property for key ".concat(r,":"),e),"REDACTED (arbitrary object)")}function Q(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}var ee,re=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return(0,u.Z)(this,t),(a=r.call(this,e)).omitPropsFromLogging=o,a._errorInstanceId=(0,_.Z)(),a.fluidErrorCode="-",o.add("omitPropsFromLogging"),o.add("_errorInstanceId"),n&&a.addTelemetryProperties(n),a}return(0,l.Z)(t,[{key:"errorInstanceId",get:function(){return this._errorInstanceId}},{key:"overwriteErrorInstanceId",value:function(e){this._errorInstanceId=e}},{key:"addTelemetryProperties",value:function(e){!function(e,r){for(var t=0,n=Object.keys(r);t<n.length;t++){var a=n[t];void 0===e[a]&&(e[a]=r[a])}}(this,e)}},{key:"getTelemetryProperties",value:function(){var e=function(e,r){for(var t={},n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(!r.has(o)){var i=e[o];K(i)?t[o]={value:$(i.value,o),tag:i.tag}:t[o]=$(i,o)}}return t}(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}],[{key:"typeCheck",value:function(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}}]),t}((0,D.Z)(Error)),te="genericError";function ne(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?ee.Online:ee.Offline:ee.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(ee||(ee={}));var ae=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,a)).canRetry=n,o.errorType=M.C.genericNetworkError,o}return(0,l.Z)(t)}(re),oe=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n){var a;return(0,u.Z)(this,t),(a=r.call(this,e,n)).errorType=M.C.fluidInvalidSchema,a.canRetry=!1,a}return(0,l.Z)(t)}(re);(function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,Object.assign(Object.assign({},n),{statusCode:400}))).errorType=t.errorType,o.canRetry=!1,o.storageOnlyReason=a,o}return(0,l.Z)(t)}(re)).errorType=M.C.deltaStreamConnectionForbidden;var ie=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a,o){var i;return(0,u.Z)(this,t),(i=r.call(this,e,o,new Set(["claims","tenantId"]))).claims=n,i.tenantId=a,i.errorType=M.C.authorizationError,i.canRetry=!1,i}return(0,l.Z)(t)}(re),ce=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a,o){var i;return(0,u.Z)(this,t),(i=r.call(this,e,o)).errorType=n,i.canRetry=a,i}return(0,l.Z)(t)}(re),se=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,n,!1,a)).errorType=n,o}return(0,l.Z)(t)}(ce),ue=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,n,!0,a)).errorType=n,o}return(0,l.Z)(t)}(ce),le=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,a)).retryAfterSeconds=n,o.errorType=M.C.throttlingError,o.canRetry=!0,o}return(0,l.Z)(t)}(re);var de=function(e){return!0===(null===e||void 0===e?void 0:e.canRetry)},ve=function(e){return void 0!==(null===e||void 0===e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0};function fe(e){return e.includes("onedrive.com")||e.includes("storage.live.com")||e.includes("storage.live-int.com")||e.includes("onedrive-tst.com")}var pe=t(37762),he=t(9070),me=t(97326),ge=t(5647),ye=t(93433),ke=t(4942),we=function(){function e(r){(0,u.Z)(this,e),this.valueGenerator=r,this._evaluated=!1}return(0,l.Z)(e,[{key:"evaluated",get:function(){return this._evaluated}},{key:"value",get:function(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}]),e}(),be=(Symbol.toStringTag,new we((function(){return Ze(Ce())})),{getRawConfig:function(){}}),Ze=function(e){return void 0!==e&&null!==e?new Se(void 0,{getRawConfig:function(r){var t,n;try{return null===(n=Ee(null!==(t=e.getItem(r))&&void 0!==t?t:void 0))||void 0===n?void 0:n.raw}catch(a){}}}):be};function Ie(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function Ee(e){var r,t=e;if("string"===typeof e)try{t=JSON.parse(e),r={raw:e,string:e}}catch(c){}if(void 0===t)return r;var n=typeof t;if(Ie(n))return Object.assign(Object.assign({},r),(0,ke.Z)({raw:e},n,t));if(Array.isArray(t)){var a=typeof t[0];if(!Ie(a))return r;var o,i=(0,pe.Z)(t);try{for(i.s();!(o=i.n()).done;){if(typeof o.value!==a)return r}}catch(s){i.e(s)}finally{i.f()}return Object.assign(Object.assign({},r),(0,ke.Z)({raw:e},"".concat(a,"[]"),t))}return r}var Ce=function(){var e;try{return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(r){return}},Se=function(){function e(r){(0,u.Z)(this,e),this.logger=r,this.configCache=new Map,this.orderedBaseProviders=[];for(var t=new Set,n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];for(var i=[].concat(a);i.length>0;){var c=i.shift();void 0!==c&&Ne(c)&&!t.has(c)&&(t.add(c),c instanceof e?i.push.apply(i,(0,ye.Z)(c.orderedBaseProviders)):this.orderedBaseProviders.push(c))}}return(0,l.Z)(e,[{key:"getBoolean",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r.boolean}},{key:"getNumber",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r.number}},{key:"getString",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r.string}},{key:"getBooleanArray",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r["boolean[]"]}},{key:"getNumberArray",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r["number[]"]}},{key:"getStringArray",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r["string[]"]}},{key:"getRawConfig",value:function(e){var r;return null===(r=this.getCacheEntry(e))||void 0===r?void 0:r.raw}},{key:"getCacheEntry",value:function(e){var r;if(!this.configCache.has(e)){var t,n=(0,pe.Z)(this.orderedBaseProviders);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=Ee(null===a||void 0===a?void 0:a.getRawConfig(e));if(void 0!==o)return this.configCache.set(e,o),null===(r=this.logger)||void 0===r||r.send(Object.assign({category:"generic",eventName:"ConfigRead"},Ge({configName:e,configValue:JSON.stringify(o)}))),o}}catch(i){n.e(i)}finally{n.f()}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}]),e}();function Pe(e){var r=e;return Ne(null===r||void 0===r?void 0:r.config)&&void 0!==(null===r||void 0===r?void 0:r.logger)}function xe(e){if(Pe(e))throw new Error("Logger is already a monitoring context");for(var r=e,t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return r.config=(0,ge.Z)(Se,[e].concat(n)),r.logger=e,r}function Ne(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}var Re,Te=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]])}return t};function Oe(e){if(void 0!==e&&null!==e){var r=Number(e);return Number.isNaN(r)?e:r}}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(Re||(Re={}));var Le=function(){function e(r,t){(0,u.Z)(this,e),this.namespace=r,this.properties=t}return(0,l.Z)(e,[{key:"sendTelemetryEvent",value:function(e,r){var t;this.sendTelemetryEventCore(Object.assign(Object.assign({},e),{category:null!==(t=e.category)&&void 0!==t?t:"generic"}),r)}},{key:"sendTelemetryEventCore",value:function(r,t){var n,a=function(e){for(var r=e.category,t=e.eventName,n=Te(e,["category","eventName"]),a={category:r,eventName:t},o=0,i=Object.keys(n);o<i.length;o++){var c=i[o];a[c]=Me(n[c])}return a}(r);void 0!==t&&e.prepareErrorObject(a,t,!1),"number"===typeof a.duration&&(a.duration=(n=a.duration,Math.floor(n))),this.send(a)}},{key:"sendErrorEvent",value:function(e,r){this.sendTelemetryEventCore(Object.assign(Object.assign({error:e.eventName},e),{category:"error"}),r)}},{key:"sendPerformanceEvent",value:function(e,r){var t,n=Object.assign(Object.assign({},e),{category:null!==(t=e.category)&&void 0!==t?t:"performance"});this.sendTelemetryEventCore(n,r)}},{key:"prepareEvent",value:function(r){var t="error"===r.category||void 0!==r.error,n=Object.assign({},r);return void 0!==this.namespace&&(n.eventName="".concat(this.namespace).concat(e.eventNamespaceSeparator).concat(n.eventName)),this.extendProperties(n,t)}},{key:"extendProperties",value:function(e,r){var t=e;if(this.properties){var n=[];n.push(this.properties.all),r&&n.push(this.properties.error);for(var a=0,o=n;a<o.length;a++){var i=o[a];if(void 0!==i)for(var c=0,s=Object.keys(i);c<s.length;c++){var u=s[c];if(void 0===t[u]){var l=i[u],d="function"===typeof l?l():l;void 0!==d&&(t[u]=d)}}}}return e}}],[{key:"formatTick",value:function(e){return Math.floor(e)}},{key:"numberFromString",value:function(e){if(void 0!==e&&null!==e){var r=Number(e);return Number.isNaN(r)?e:r}}},{key:"sanitizePkgName",value:function(e){return e.replace("@","").replace("/","-")}},{key:"prepareErrorObject",value:function(e,r,t){var n=W(r,!0),a=n.message,o=n.errorType,i=n.stack;if(e.stack=i,e.error=a,e.errorType=o,J(r))for(var c=r.getTelemetryProperties(),s=0,u=Object.keys(c);s<u.length;s++){var l=u[s];void 0===e[l]&&(e[l]=c[l])}void 0===e.stack&&t&&(e.stack=B())}}]),e}();Le.eventNamespaceSeparator=":";var Ue=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,n,a)).baseLogger=e,Pe(e)&&xe((0,me.Z)(o),new Se((0,me.Z)(o),e.config)),o}return(0,l.Z)(t,[{key:"send",value:function(e){this.baseLogger.send(this.prepareEvent(e))}}],[{key:"create",value:function(e,r,n){if(e instanceof t){for(var a={},o=0,i=[e.properties,n];o<i.length;o++){var c=i[o];void 0!==c&&(void 0!==c.all&&(a.all=Object.assign(Object.assign({},a.all),c.all)),void 0!==c.error&&(a.error=Object.assign(Object.assign({},a.error),c.error)))}var s=void 0===e.namespace?r:void 0===r?e.namespace:"".concat(e.namespace).concat(Le.eventNamespaceSeparator).concat(r);return new t(e.baseLogger,s,a)}return new t(e||new Ae,r,n)}}]),t}(Le);var je=function(){function e(r,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,u.Z)(this,e),this.logger=r,this.markers=a,this.recordHeapSize=o,this.startTime=he.S.now(),this.startMemoryCollection=0,this.event=Object.assign({},t),this.markers.start&&this.reportEvent("start"),"object"===typeof window&&null!=window&&(null===(n=window.performance)||void 0===n?void 0:n.mark)&&(this.startMark="".concat(t.eventName,"-start"),window.performance.mark(this.startMark))}return(0,l.Z)(e,[{key:"duration",get:function(){return he.S.now()-this.startTime}},{key:"reportProgress",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(r,e)}},{key:"autoEnd",value:function(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}},{key:"end",value:function(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}},{key:"performanceEndMark",value:function(){if(this.startMark&&this.event){var e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}},{key:"cancel",value:function(e,r){void 0!==this.markers.cancel&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),r),this.event=void 0}},{key:"reportEvent",value:function(e,r,t){var n,a,o,i;if(this.event){var c=Object.assign(Object.assign({},this.event),r);if(c.eventName="".concat(c.eventName,"_").concat(e),"start"!==e){if(c.duration=this.duration,this.startMemoryCollection){var s=null===(a=null===(n=he.S)||void 0===n?void 0:n.memory)||void 0===a?void 0:a.usedJSHeapSize,u=Math.floor((s-this.startMemoryCollection)/1024);u>0&&(c.usedJSHeapSize=u)}}else this.recordHeapSize&&(this.startMemoryCollection=null===(i=null===(o=he.S)||void 0===o?void 0:o.memory)||void 0===i?void 0:i.usedJSHeapSize);this.logger.sendPerformanceEvent(c,t)}}}],[{key:"start",value:function(r,t,n){return new e(r,t,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}},{key:"timedExec",value:function(r,t,n,a){var o=e.start(r,t,a);try{var i=n(o);return o.autoEnd(),i}catch(c){throw o.cancel(void 0,c),c}}},{key:"timedExecAsync",value:function(){var r=(0,o.Z)((0,n.Z)().mark((function r(t,a,o,i,c){var s,u;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.start(t,a,i,c),r.prev=1,r.next=4,o(s);case 4:return u=r.sent,s.autoEnd(),r.abrupt("return",u);case 9:throw r.prev=9,r.t0=r.catch(1),s.cancel(void 0,r.t0),r.t0;case 13:case"end":return r.stop()}}),r,null,[[1,9]])})));return function(e,t,n,a,o){return r.apply(this,arguments)}}()}]),e}(),Ae=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"send",value:function(e){}}]),e}();function Me(e){return K(e)?{value:Fe(e.value),tag:e.tag}:Fe(e)}function Fe(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}var Ge=function(e){return function(e,r){return Object.entries(r).filter((function(e){return void 0!==e[1]})).reduce((function(r,t){return r[t[0]]={tag:e,value:t[1]},r}),{})}(Re.CodeArtifact,e)},De=t(55742);var _e="Bearer";var Ve="2.0.0-internal.5.4.2",ze=712,He="serviceReadOnly";function We(e){var r={sprequestduration:Oe(e.get("sprequestduration")),contentsize:Oe(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach((function(t){var n=e.get(t.headerName);void 0!==n&&null!==n&&(r[t.logName]=n)}));var t=e.get("x-fluid-telemetry");if(void 0!==t&&null!==t){r.xFluidTelemetry=t;var n,a=t.split(",").map((function(e){return e.split("=")})),o=(0,pe.Z)(a);try{for(o.s();!(n=o.n()).done;){var i=(0,O.Z)(n.value,2),c=i[0],s=i[1];if("Origin"===c.trim()){var u=void 0;switch(null===s||void 0===s?void 0:s.trim()){case"c":u="cache";break;case"g":u="graph";break;default:u=null===s||void 0===s?void 0:s.trim()}r.responseOrigin=u;break}}}catch(l){o.e(l)}finally{o.f()}}return r}var qe=function(e){(0,F.Z)(t,e);var r=(0,G.Z)(t);function t(e,n,a){var o;return(0,u.Z)(this,t),(o=r.call(this,e,a,new Set(["redirectLocation"]))).redirectLocation=n,o.errorType=M.C.fileNotFoundOrAccessDeniedError,o.canRetry=!1,o}return(0,l.Z)(t)}(re);function Je(e,r,t,n,a){var o,i,c,s,u,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},d=function(e){try{if(void 0!==e){var r=JSON.parse(e);if(function(e){var r=null===e||void 0===e?void 0:e.error;return"string"===typeof(null===r||void 0===r?void 0:r.message)&&(void 0===(null===r||void 0===r?void 0:r.code)||"string"===typeof(null===r||void 0===r?void 0:r.code))}(r))return{success:!0,errorResponse:r}}}catch(t){}return{success:!1}}(a);if(d.success){var f=d.errorResponse;l.responseMessage=f.error.message,c=function(e){for(var r=[],t=e.error;"object"===typeof t&&null!==t;)void 0!==t.code&&r.unshift(t.code),t=t.innerError;return r}(f),void 0!==c&&(s=c[0],l.innerMostErrorCode=s)}var p=Object.assign({driverVersion:Ve,statusCode:r},l);switch(r){case 400:if("fluidInvalidSchema"===s){i=new oe(e,p);break}i=new se(e,M.C.genericNetworkError,p);break;case 401:case 403:if(s===He)i=new ue(e,De.x.serviceReadOnly,p);else{var h=(null===n||void 0===n?void 0:n.headers)?function(e){var r=e.get("www-authenticate");if(r){var t,n=!1;return r.split(",").map((function(e){var r=e.split("=");r.length>=2&&(n||"error"!==r[0].trim().toLowerCase()?t||"claims"!==r[0].trim().toLowerCase()||(t=(0,v.fW)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):n="insufficient_claims"===JSON.parse(r[1].trim().toLowerCase()))})),n?t:void 0}}(n.headers):void 0,m=(null===n||void 0===n?void 0:n.headers)?function(e){var r=e.get("www-authenticate");if(r){var t,n=r.indexOf(_e);if(!(n<0))return r.substring(n+_e.length).split(",").map((function(e){if(!t){var r=e.split("=");r.length>=2&&"realm"===r[0].trim().toLowerCase()&&(t=JSON.parse(r[1].trim()))}})),t}}(n.headers):void 0;i=new ie(e,h,m,p)}break;case 404:if(d.success){var g=null===(o=null===d||void 0===d?void 0:d.errorResponse)||void 0===o?void 0:o.error;if(void 0!==(u=null===g||void 0===g?void 0:g["@error.redirectLocation"])){i=new qe(e,u,p);break}}i=new se(e,M.C.fileNotFoundOrAccessDeniedError,p);break;case 406:i=new se(e,M.C.unsupportedClientProtocolVersion,p);break;case 410:i=new se(e,De.x.cannotCatchUp,p);break;case 409:i=new se(e,M.C.fileOverwrittenInStorage,p);break;case 412:i=new se(e,M.C.genericNetworkError,p);break;case 413:i=new se(e,De.x.snapshotTooBig,p);break;case 414:i=new se(e,De.x.invalidFileNameError,p);break;case 423:if("resourceLocked"===s||"resourceCheckedOut"===s){i=new se(e,M.C.fileIsLocked,p);break}case 500:i=new ue(e,M.C.genericNetworkError,p);break;case 501:i=new se(e,De.x.fluidNotEnabled,p);break;case 507:i=new se(e,De.x.outOfStorageError,p);break;case ze:i=new se(e,M.C.incorrectServerResponse,p);break;default:i=function(e,r,t){return void 0!==r.retryAfterMs&&r.canRetry?new le(e,r.retryAfterMs/1e3,t):new ae(e,r.canRetry,t)}(e,{canRetry:!0,retryAfterMs:void 0!==t?1e3*t:void 0},p)}return i.addTelemetryProperties({endpointReached:!0}),function(e,r,t){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=ee[ne()],void 0!==t&&(e.facetCodes=t);if(r&&(a.responseType=r.type,r.headers)){for(var o=We(r.headers),i=0,c=Object.keys(o);i<c.length;i++){var s=c[i];a[s]=o[s]}e.serverEpoch=null!==(n=r.headers.get("x-fluid-epoch"))&&void 0!==n?n:void 0}e.addTelemetryProperties(a)}(i,n,c,void 0),i}function Be(e,r,t,n,a){var o=Je(e,r,function(e){if(null===e)return;var r=Number(e);if(Number.isNaN(r))return;return r}(t.headers.get("retry-after")),t,n,a);throw o.addTelemetryProperties({odspError:!0,storageServiceError:!0}),o}var Xe=function(e){return null===e||"string"===typeof e?e:void 0===e?null:e.token},Ye=function(e){return null===e||"string"===typeof e?void 0:e.fromCache},Ke=t(45359),$e=t.n(Ke),Qe=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e()(r,t));case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),er="2.0.0-internal.5.4.2",rr="getWithRetryForTokenRefreshRepeat";function tr(e){var r,t=new Map,n=(0,pe.Z)(e.entries());try{for(n.s();!(r=n.n()).done;){var a=(0,O.Z)(r.value,2),o=a[0],i=a[1];t.set(o,i)}}catch(c){n.e(c)}finally{n.f()}return t}function nr(e){return ar.apply(this,arguments)}function ar(){return ar=(0,o.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r({refresh:!1}).catch(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={refresh:!0,previousError:t},e.t0=t.errorType,e.next=e.t0===M.C.authorizationError?4:e.t0===M.C.incorrectServerResponse||e.t0===De.x.fetchTokenError?5:6;break;case 4:return e.abrupt("return",r(Object.assign(Object.assign({},a),{claims:t.claims,tenantId:t.tenantId})));case 5:return e.abrupt("return",r(a));case 6:if(!0!==t[rr]){e.next=8;break}return e.abrupt("return",r(a));case 8:throw t;case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),ar.apply(this,arguments)}function or(e,r){return ir.apply(this,arguments)}function ir(){return ir=(0,o.Z)((0,n.Z)().mark((function e(r,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=he.S.now(),e.abrupt("return",Qe(r,t).then(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r){e.next=3;break}throw new se("No response from ODSP fetch call",M.C.incorrectServerResponse,{driverVersion:er});case 3:if(!(!t.ok||t.status<200||t.status>=300)){e.next=12;break}return e.t0=Be,e.t1="ODSP fetch error [".concat(t.status,"]"),e.t2=t.status,e.t3=t,e.next=10,t.text();case 10:e.t4=e.sent,(0,e.t0)(e.t1,e.t2,e.t3,e.t4);case 12:return o=tr(t.headers),e.abrupt("return",{content:t,headers:o,propsToLog:We(o),duration:he.S.now()-a});case 14:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),(function(e){var r=ne(),t={value:"".concat(e),tag:Re.UserData},n=t.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new ue("Fetch Timeout (AbortError)",De.x.fetchTimeout,{driverVersion:er});if(n.includes("ETIMEDOUT"))throw new ue("Fetch Timeout (ETIMEDOUT)",De.x.fetchTimeout,{driverVersion:er});throw r===ee.Offline?new ue("ODSP fetch failure (Offline): ".concat(n),M.C.offlineError,{driverVersion:er,rawErrorMessage:t}):new ue("ODSP fetch failure: ".concat(n),M.C.fetchFailure,{driverVersion:er,rawErrorMessage:t})})));case 2:case"end":return e.stop()}}),e)}))),ir.apply(this,arguments)}function cr(e){return(0,L.h)(!0===e.odspResolvedUrl,478),e}function sr(e,r,t,a){return function(){var i=(0,o.Z)((0,n.Z)().mark((function i(c,s){var u,l=arguments;return(0,n.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=l.length>2&&void 0!==l[2]&&l[2],i.abrupt("return",je.timedExecAsync(e,{eventName:"".concat(s,"_GetToken"),attempts:c.refresh?2:1,hasClaims:!!c.claims,hasTenantId:!!c.tenantId},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(Object.assign(Object.assign({},c),r)).then((function(e){var r=Xe(e);if((u||o.duration>=32)&&o.end({fromCache:Ye(e),isNull:null===r}),null===r&&a)throw new se("The Host-provided token fetcher returned null",De.x.fetchTokenError,{method:s,driverVersion:er});return r}),(function(e){var r=null===e||void 0===e?void 0:e.canRetry;throw X(e,(function(e){return new ce("The Host-provided token fetcher threw an error",De.x.fetchTokenError,"boolean"===typeof r&&r,{method:s,errorMessage:e,driverVersion:er})}))})));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),{cancel:"generic"}));case 2:case"end":return i.stop()}}),i)})));return function(e,r){return i.apply(this,arguments)}}()}var ur=t(24071),lr=t(14503);function dr(e,r){return vr.apply(this,arguments)}function vr(){return(vr=(0,o.Z)((0,n.Z)().mark((function e(r,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ur.pv.from("".concat(r,"_").concat(t)),e.t0=encodeURIComponent,e.next=4,(0,lr.T)(a,"SHA-256","base64");case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fr(e,r,t,n){var a=new URL(e).origin,o=n?"versions/".concat(n,"/"):"";return"".concat(function(e){var r="_api/";return fe(e)&&(r=""),"".concat(e,"/").concat(r,"v2.1")}(a),"/drives/").concat(r,"/items/").concat(t,"/").concat(o)}function pr(e,r,t,n){var a=fr(e,r,t,n);return"".concat(a,"opStream/snapshots")}function hr(e,r,t,n){var a=fr(e,r,t,n);return"".concat(a,"opStream/attachment")}function mr(e,r,t,n){var a=fr(e,r,t,n);return"".concat(a,"opStream/attachments")}function gr(e,r,t,n){var a=fr(e,r,t,n);return"".concat(a,"opStream")}var yr=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"resolve",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,a,o,i,c,s,u,l,d,v,f,p,h,m,g,y,k,w,b,Z,I,E,C,P,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=r.headers)||void 0===t?void 0:t[T.createNew])){e.next=12;break}if(c=r.url.split("?"),s=(0,O.Z)(c,2),u=s[0],l=s[1],d=new URLSearchParams(l),v=r.headers[T.createNew].fileName,f=d.get("driveId"),p=d.get("path"),h=d.get("containerPackageName"),m=d.get("createLinkType"),v&&u&&f&&null!==p&&void 0!==p){e.next=10;break}throw new se("Proper new file params should be there!!",M.C.genericError,{driverVersion:er});case 10:return m&&m in U&&(g={createLink:{type:U[m]}}),e.abrupt("return",{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:"fluid-odsp://".concat(u,"?").concat(l,"&version=null"),siteUrl:u,hashedDocumentId:"",driveId:f,itemId:"",fileName:v,summarizer:!1,codeHint:{containerPackageName:null!==h&&void 0!==h?h:void 0},fileVersion:void 0,shareLinkInfo:g,isClpCompliantApp:null===(a=r.headers)||void 0===a?void 0:a[S.isClpCompliantApp]});case 12:return y=kr(r.url),k=y.siteUrl,w=y.driveId,b=y.itemId,Z=y.path,I=y.containerPackageName,E=y.fileVersion,e.next=15,dr(w,b);case 15:return C=e.sent,(0,L.h)(!C.includes("/"),168),P="fluid-odsp://placeholder/placeholder/".concat(C,"/").concat((n=Z).startsWith("/")?n.substr(1):n),x=!!(null===(o=r.headers)||void 0===o?void 0:o[T.summarizingClient]),e.abrupt("return",{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:pr(k,w,b,E),attachmentPOSTStorageUrl:hr(k,w,b,E),attachmentGETStorageUrl:mr(k,w,b,E),deltaStorageUrl:gr(k,w,b,E)},id:C,tokens:{},url:P,hashedDocumentId:C,siteUrl:k,driveId:w,itemId:b,dataStorePath:Z,fileName:"",summarizer:x,codeHint:{containerPackageName:I},fileVersion:E,isClpCompliantApp:null===(i=r.headers)||void 0===i?void 0:i[S.isClpCompliantApp]});case 20:case"end":return e.stop()}var n}),e)})));return function(r){return e.apply(this,arguments)}}()},{key:"getAbsoluteUrl",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t,a){var o,i,c,s,u,l,d,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=cr(r),l=t,""===t&&void 0!==u.dataStorePath&&(l=u.dataStorePath),l.startsWith("/")&&(l=l.substr(1)),d=function(e){return"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid)},v=null!==(v=a&&"name"in a?a.name:d(null===(o=a)||void 0===o?void 0:o.package)?null===(i=a)||void 0===i?void 0:i.package.name:null===(c=a)||void 0===c?void 0:c.package)&&void 0!==v?v:null===(s=u.codeHint)||void 0===s?void 0:s.containerPackageName,e.abrupt("return",R(Object.assign(Object.assign({},u),{containerPackageName:v,dataStorePath:l})));case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}()}]),e}();function kr(e){var r=e.split("?"),t=(0,O.Z)(r,2),n=t[0],a=t[1],o=new URLSearchParams(a),i=o.get("driveId"),c=o.get("itemId"),s=o.get("path"),u=o.get("containerPackageName"),l=o.get("fileVersion");if(null===i)throw new Error("ODSP URL did not contain a drive id");if(null===c)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:n,driveId:decodeURIComponent(i),itemId:decodeURIComponent(c),path:decodeURIComponent(s),containerPackageName:u?decodeURIComponent(u):void 0,fileVersion:l?decodeURIComponent(l):void 0}}var wr=t(5927),br="2.0.0-internal.5.4.2";function Zr(e,r,t,n){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,o.Z)((0,n.Z)().mark((function e(r,t,a,o){var i,c,s,u,l,d,v,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=!1,l=1e3,d=0,v=he.S.now();case 4:return e.prev=4,e.next=7,r(o.cancel);case 7:s=e.sent,u=!0,e.next=26;break;case 11:if(e.prev=11,e.t0=e.catch(4),de(e.t0)){e.next=16;break}throw a.sendTelemetryEvent({eventName:"".concat(t,"_cancel"),retry:d,duration:he.S.now()-v,fetchCallName:t},e.t0),e.t0;case 16:if(!0!==(null===(i=o.cancel)||void 0===i?void 0:i.aborted)){e.next=19;break}throw a.sendTelemetryEvent({eventName:"".concat(t,"_runWithRetryAborted"),retry:d,duration:he.S.now()-v,fetchCallName:t,reason:o.cancel.reason},e.t0),new se("runWithRetry was Aborted",M.C.genericError,{driverVersion:br,fetchCallName:t,reason:o.cancel.reason});case 19:return 0===d&&a.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),duration:he.S.now()-v,fetchCallName:t},e.t0),d++,f=e.t0,l=null!==(c=ve(e.t0))&&void 0!==c?c:Math.min(2*l,(p=e.t0,"string"===typeof(null===(n=p)||void 0===n?void 0:n.errorType)&&"string"===typeof(null===n||void 0===n?void 0:n.message)&&z(n)&&V(n)&&!0===p.getTelemetryProperties().endpointReached?Er:Cr)),o.onRetry&&o.onRetry(l,e.t0),e.next=26,(0,wr.g)(l);case 26:if(!u){e.next=4;break}case 27:return d>0&&a.sendTelemetryEvent({eventName:"".concat(t,"_lastError"),retry:d,duration:he.S.now()-v,fetchCallName:t},f),e.abrupt("return",s);case 29:case"end":return e.stop()}var n,p}),e,null,[[4,11]])})))).apply(this,arguments)}var Er=3e4,Cr=8e3;function Sr(e,r,t){if(!r||0===r.length)return{url:e,headers:{}};if(!t){var n=new URL(e);if(n.searchParams.set("access_token",r),n.search.length<=2048)return{headers:{},url:n.href}}return{headers:{Authorization:"Bearer ".concat(r)},url:e}}var Pr="Odsp409Error";function xr(e,r,t,n){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,o.Z)((0,n.Z)().mark((function e(r,t,a,o){var i,c,s,u,l,d,v,f,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=1e3,s=he.S.now(),l=1;case 3:return void 0!==o&&o(),e.prev=4,e.next=7,r();case 7:return d=e.sent,l>1&&a.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:l,duration:he.S.now()-s},u),e.abrupt("return",d);case 12:if(e.prev=12,e.t0=e.catch(4),v=de(e.t0),f=!0===(null===e.t0||void 0===e.t0?void 0:e.t0[Pr]),p=(null===e.t0||void 0===e.t0?void 0:e.t0.errorType)===De.x.serviceReadOnly,1===l&&a.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),callName:t,attempts:l,duration:he.S.now()-s},e.t0),(f||p)&&v){e.next=20;break}throw e.t0;case 20:if(5!==l){e.next=24;break}throw a.sendErrorEvent({eventName:f?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:l,duration:he.S.now()-s},e.t0),e.t0.canRetry=!1,e.t0;case 24:return c=null!==(i=ve(e.t0))&&void 0!==i?i:c,e.next=27,(0,wr.g)(Math.floor(c));case 27:c+=c/4*(1+Math.random()),u=e.t0;case 29:l++,e.next=3;break;case 32:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}var Rr=new Map;function Tr(e,r,t){return Or.apply(this,arguments)}function Or(){return Or=(0,o.Z)((0,n.Z)().mark((function e(r,t,a){var i,c,s,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i="".concat(t.siteUrl,"_").concat(t.driveId,"_").concat(t.itemId),void 0===(c=Rr.get(i))){e.next=4;break}return e.abrupt("return",c);case 4:return s=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var c,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=0,e.next=4,Zr((0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xr((0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lr(r,t,a));case 1:case"end":return e.stop()}}),e)}))),"getFileLinkCore",a));case 1:case"end":return e.stop()}}),e)}))),"getShareLink",a,{onRetry:function(e,r){if(5===++s){if(void 0!==r&&"object"===typeof r)throw r.canRetry=!1,r;throw r}}});case 4:c=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),Rr.delete(i),e.t0;case 11:return(0,L.h)(void 0!==c,658),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),u=s(),Rr.set(i,u),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)}))),Or.apply(this,arguments)}function Lr(e,r,t){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,o.Z)((0,n.Z)().mark((function e(r,t,a){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ar(r,t,a,!0);case 2:return i=e.sent,e.abrupt("return",je.timedExecAsync(a,{eventName:"odspFileLink",requestName:"getSharingInformation"},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(c){var s,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=0,e.next=3,nr(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){var c,l,d,v,f,p,h,m,g,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s++,l=sr(a,t,r,!0),e.next=4,l(o,"GetFileLinkCore");case 4:return d=e.sent,(0,L.h)(null!==d,699),v=Sr("".concat(t.siteUrl,"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid").concat(encodeURIComponent("'".concat(i.sharepointIds.listItemUniqueId,"'"))),d,!0),f=v.url,p=v.headers,h={method:"POST",headers:Object.assign({"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},p)},e.next=10,or(f,h);case 10:return m=e.sent,u=m.propsToLog,e.next=14,m.content.json();case 14:if(g=e.sent,"string"===typeof(y=null===(c=null===g||void 0===g?void 0:g.d)||void 0===c?void 0:c.directUrl)){e.next=18;break}throw new se("Malformed GetSharingInformation response",M.C.incorrectServerResponse,{driverVersion:er});case 18:return e.abrupt("return",y);case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 3:return l=e.sent,c.end(Object.assign(Object.assign({},u),{attempts:s})),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),Ur.apply(this,arguments)}var jr=function(e){return"string"===typeof e.webUrl&&"string"===typeof e.webDavUrl&&"object"===typeof e.sharepointIds};function Ar(e,r,t,n){return Mr.apply(this,arguments)}function Mr(){return Mr=(0,o.Z)((0,n.Z)().mark((function e(r,t,a,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",je.timedExecAsync(a,{eventName:"odspFileLink",requestName:"getFileItemLite"},function(){var e=(0,o.Z)((0,n.Z)().mark((function e(c){var s,u,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=0,e.next=3,nr(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(o){var c,l,d,v,f,p,h,m,g,y,k;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s++,c=t.siteUrl,l=t.driveId,d=t.itemId,v=sr(a,t,r,!0),e.next=5,v(o,"GetFileItemLite");case 5:return f=e.sent,(0,L.h)(null!==f,700),p=Sr("".concat(c,"/_api/v2.0/drives/").concat(l,"/items/").concat(d,"?select=webUrl,webDavUrl,sharepointIds"),f,i),h=p.url,m=p.headers,g={method:"GET",headers:m},e.next=11,or(h,g);case 11:return y=e.sent,u=y.propsToLog,e.next=15,y.content.json();case 15:if(k=e.sent,jr(k)){e.next=18;break}throw new se("Malformed getFileItemLite response",M.C.incorrectServerResponse,{driverVersion:er});case 18:return e.abrupt("return",k);case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 3:return l=e.sent,c.end(Object.assign(Object.assign({},u),{attempts:s})),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),Mr.apply(this,arguments)}var Fr=function(){function e(r,t,n,a){(0,u.Z)(this,e),this.appName=n,this.getContext=a,this.sharingLinkCache=new d.t,this.logger=function(e){return Ue.create(e,"OdspDriver",{all:{driverVersion:er}})}(t),r&&(this.shareLinkFetcherProps=Object.assign(Object.assign({},r),{tokenFetcher:r.tokenFetcher}))}return(0,l.Z)(e,[{key:"appendDataStorePath",value:function(e,r){var t=N(e);if(t){var n=new URL(t.dataStorePath,"".concat(e.protocol,"//").concat(e.hostname));if(r.startsWith("/?")||r.startsWith("?"))new URLSearchParams(r).forEach((function(e,r){n.searchParams.append(r,e)})),t.dataStorePath="".concat(n.pathname).concat(n.search);else t.dataStorePath="".concat(n.pathname).concat(n.pathname.endsWith("/")||r.startsWith("/")?"":"/").concat(r,"/").concat(n.search);return x(e,t),e.href}}},{key:"getKey",value:function(e){return"".concat(e.siteUrl,",").concat(e.driveId,",").concat(e.itemId)}},{key:"resolve",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,a,o,i,c,s,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o={headers:r.headers,url:r.url},i=null===(t=o.headers)||void 0===t?void 0:t[C.isSharingLinkToRedeem];try{c=new URL(r.url),(s=N(c))&&(o.url=R(s))}catch(n){}return e.next=5,(new yr).resolve(o);case 5:return u=e.sent,i&&(u.shareLinkInfo=Object.assign(null!==(a=u.shareLinkInfo)&&void 0!==a?a:{},{sharingLinkToRedeem:this.removeNavParam(r.url)})),u.itemId&&this.getShareLinkPromise(u).catch((function(){})),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"removeNavParam",value:function(e){var r=new URL(e),t=new URLSearchParams(r.search);return t.delete(P),r.search=t.toString(),r.href}},{key:"getShareLinkPromise",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,a,i,c=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.shareLinkFetcherProps){e.next=2;break}throw new Error("Failed to get share link because share link fetcher props are missing");case 2:if(r.siteUrl&&r.driveId&&r.itemId){e.next=4;break}throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");case 4:if(t=this.getKey(r),!(a=this.sharingLinkCache.get(t))){e.next=8;break}return e.abrupt("return",a);case 8:return i=Tr(this.shareLinkFetcherProps.tokenFetcher,r,this.logger).catch((function(e){throw c.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),c.sharingLinkCache.remove(t),e})),this.sharingLinkCache.add(t,(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i);case 1:case"end":return e.stop()}}),e)})))),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"getAbsoluteUrl",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t,a){var o,i,c,s,u,l,d,v,f,p,h,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=cr(r),e.next=3,this.getShareLinkPromise(l);case 3:return d=e.sent,v=new URL(d),f=t,""===t&&void 0!==l.dataStorePath&&(f=l.dataStorePath),p=function(e){return"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid)},h=null!==(h=a&&"name"in a?a.name:p(null===(o=a)||void 0===o?void 0:o.package)?null===(i=a)||void 0===i?void 0:i.package.name:null===(c=a)||void 0===c?void 0:c.package)&&void 0!==h?h:null===(s=l.codeHint)||void 0===s?void 0:s.containerPackageName,e.next=12,null===(u=this.getContext)||void 0===u?void 0:u.call(this,l,f);case 12:return m=e.sent,x(v,{siteUrl:l.siteUrl,driveId:l.driveId,itemId:l.itemId,dataStorePath:f,appName:this.appName,containerPackageName:h,fileVersion:l.fileVersion,context:m}),e.abrupt("return",v.href);case 15:case"end":return e.stop()}}),e,this)})));return function(r,t,n){return e.apply(this,arguments)}}()}],[{key:"createDocumentUrl",value:function(e,r){var t=new URL(e);return x(t,r),t.href}},{key:"createNavParam",value:function(e){return E(e)}}]),e}(),Gr=t(39680),Dr=t(21572),_r=new Map;function Vr(e,r,t,u,l,d){var v=(0,i.P)(r),f="".concat(v,"_").concat(t,"_").concat(u);if(!_r.has(f)){var p=function(){var i=(0,o.Z)((0,n.Z)().mark((function i(){var p,h,m,g,y,k,w,b;return(0,n.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return m="".concat(v,"/_api/v2.0/drives/").concat(t,"/items/").concat(u,"?select=sharepointIds"),g={getToken:function(n){var o=(0,a.Z)((0,a.Z)({},n),{},{siteUrl:r,driveId:t,itemId:u});return e.getToken(["".concat(v,"/files.readwrite.all")],o)},url:m,tenantId:d,requestInit:{method:"GET"},retryPolicy:Gr.Uj,tokenPolicy:(0,Gr.Gh)(e)},y=l?(0,c.Y)((0,a.Z)((0,a.Z)({},g),{},{logger:l,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.I)(r));case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()})):(0,c.h)(g),i.prev=3,i.next=6,y;case 6:k=i.sent.result,i.next=11;break;case 9:i.prev=9,i.t0=i.catch(3);case 11:if(null===(p=k)||void 0===p||!p.ok){i.next=26;break}return i.prev=12,i.next=15,k.json();case 15:b=i.sent,i.next=21;break;case 18:i.prev=18,i.t1=i.catch(12),l&&(0,Dr.uX)(l,{eventName:"GetFileSharepointIdsResponseParseError"},i.t1);case 21:if(null===(w=b)||void 0===w||!w.sharepointIds){i.next=25;break}return i.abrupt("return",b.sharepointIds);case 25:l&&(0,Dr.uX)(l,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"));case 26:return 404!==(null===(h=k)||void 0===h?void 0:h.status)&&_r.delete(f),i.abrupt("return",void 0);case 28:case"end":return i.stop()}}),i,null,[[3,9],[12,18]])})));return function(){return i.apply(this,arguments)}}();_r.set(f,p())}return _r.get(f).then()}function zr(e,r,t,n,a,o){return Hr.apply(this,arguments)}function Hr(){return Hr=(0,o.Z)((0,n.Z)().mark((function e(r,t,u,l,d,v){var f,p,h,m,g,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=(0,i.P)(t),h="".concat(p,"/_api/v2.0/drives/").concat(u,"/items/").concat(l,"?select=webUrl,webDavUrl,name,sharepointIds"),m={getToken:function(e){var n=(0,a.Z)((0,a.Z)({},e),{},{siteUrl:t,driveId:u,itemId:l});return r.getToken(["".concat(p,"/files.readwrite.all")],n)},url:h,tenantId:v,requestInit:{method:"GET"},retryPolicy:Gr.Uj,tokenPolicy:(0,Gr.Gh)(r)},g=d?(0,c.Y)((0,a.Z)((0,a.Z)({},m),{},{logger:d,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.I)(r));case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()})):(0,c.h)(m),e.prev=4,e.next=7,g;case 7:y=e.sent.result,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(null===(f=y)||void 0===f||!f.ok){e.next=22;break}return e.prev=13,e.next=16,y.json();case 16:return e.abrupt("return",e.sent);case 19:e.prev=19,e.t1=e.catch(13),d&&(0,Dr.uX)(d,{eventName:"GetFileItemLiteResponseParseError"},e.t1);case 22:return e.abrupt("return",void 0);case 23:case"end":return e.stop()}}),e,null,[[4,10],[13,19]])}))),Hr.apply(this,arguments)}var Wr=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t,a,o){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qr(r)){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.abrupt("return",zr(t,r.siteUrl,r.driveId,r.itemId,a,o).then((function(e){var r=null===e||void 0===e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==r&&r>0)return null===e||void 0===e?void 0:e.webDavUrl.substring(0,r)})));case 3:case"end":return e.stop()}}),e)})));return function(r,t,n,a){return e.apply(this,arguments)}}(),qr=function(e){return"driveId"in e&&"siteUrl"in e&&"itemId"in e},Jr=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new Fr,e.next=4,t.resolve({url:r});case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(void 0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=4676.a1d3814e.chunk.js.map