"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[835],{2497:function(e,t,n){n.r(t),n.d(t,{StreamEmbeddedRenderer:function(){return et}});var r=n(1413),i=n(29439),o=n(72791),a=n(96013),s=n(5769),c=n(75632),u=n(73562),l=n(71507),d=n(78339),p=n(69438),h=n(2701),f=n(4942),m="playerInteractiveTimestamp";function v(){return{setIsReady:function(e,t){var n;t.playerInteractiveTimestamp&&e.setResult(!0,(n={},(0,f.Z)(n,m,Math.round(t.playerInteractiveTimestamp)),(0,f.Z)(n,"unfurlDurationMs_performanceNow",Math.round(t.playerInteractiveTimestamp-e.startTime)),n))},addAdditionalProps:function(e,t){e.addAdditionalProps(t)}}}var y=n(19426);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.E.VideoLoadFromUnfurl;return e.activities.get(t)}var _=[" ","Enter"],w=[].concat(_,["Tab"]);function g(e){return"warmData"in e}var k=n(33874),E=n(74165),S=n(15861),P=n(97349),T=n(70897),I=n(55520),O=function(e,t,n,r,i,o,a,s){this.level=e,this.isExpected=t,this.scenario=n,this.knownError=r,this.originalError=i,this.message=o,this.playbackSessionId=a,this.hostSessionId=s},M=n(75971),C=function(e){this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=e},A=function(){function e(e){this._observers=new Array,this.onCallbackError=e}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var n=new C(e);return n.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(n),this.internalRemove.bind(this,n)},e.prototype.notify=function(e){for(var t=0,n=this._observers;t<n.length;t++){var r=n[t];if(!r.willBeUnregistered){try{r.callback(e)}catch(i){this.onCallbackError&&this.onCallbackError(i)}r.unregisterOnNextCall&&this.deferUnregister(r)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout((function(){t.internalRemove(e)}),0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),R=function(){function e(e,t){this._observable=new A(t),this._value=e,this.onCallbackError=t}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var n=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(n)try{e(this._value)}catch(r){this.onCallbackError&&this.onCallbackError(r)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&n?function(){}:this._observable.subscribe(e,t)},e}(),U=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function x(e,t){var n=e,r=n.dispose,i="function"===typeof r&&r.disposalChain||function(e){var t=new U(e),n=e.dispose,r=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=r,r.disposalChain=t,t}(n);return i.addCallback(t),n}var D=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),r=x(e,(function(){delete t._disposables[n]}));return this._disposables[n]=r,r},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i&&"function"===typeof i.dispose&&i.dispose(),delete e[r]}},e}(),N=function(){function e(e){this._scope=new D,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var r;if(F(e))r=e;else{var i=this._targetMap.get(e);i?r=i:(r=new EventTarget,this._targetMap.set(e,r))}r.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){r.removeEventListener(t,n)}});o.set(t,a)},e.prototype.off=function(e,t,n){var r;if(F(e))r=e;else{var i=this._targetMap.get(e);i&&(r=i)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}r&&r.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function F(e){return!!e.addEventListener}var L=function(){function e(e){this._scope=new D,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,r=setTimeout((function(){n._timeoutMap.delete(r),e()}),t),i=this._scope.attach({dispose:function(){clearTimeout(r)}});return this._timeoutMap.set(r,i),r},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),V="unsupportedCommand",W="handlerError",H="handlerRejection",j="acknowledgeTimeout",Z="resultTimeout",K="setupTimeout",G="canceled",B="disposed",z=0,J=function(){function e(e,t){void 0===t&&(t={});var n=this,r=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,c=e.ackTimeoutMs,u=void 0===c?1e3:c,l=e.resultTimeoutMs,d=void 0===l?1e4:l,p=t.asyncType,h=void 0===p?L:p,f=t.eventGroupType,m=void 0===f?N:f,v=this._scope=new D;v.attach(o);var y,b=this._async=v.attach(new h(this)),_=v.attach(new m(this));this._ackTimeoutMs=u,this._resultTimeoutMs=d,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch((function(e){return{result:"error",error:{code:(e=e||{name:H,isExpected:!1,message:"Unknown error"}).code||e.name||H,message:e.message||"".concat(e)},isExpected:!!e.isExpected}})):Promise.resolve({result:"error",error:{code:V,message:e.command},isExpected:!0})}catch(n){return Promise.resolve({result:"error",isExpected:!1,error:{code:W,message:n&&"Name: ".concat(n.name,"; Message: ").concat(n.message||n)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(a){}};var w=this._port=new Promise((function(t,r){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=G,r(e)}}),y=b.setTimeout((function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=K,r(e)}),s),e.init((function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});_.on(e,"message",(function(t){var r=t.data;if(r&&"object"===typeof r)return"acknowledge"===r.type?n._onAcknowledge(r):"command"===r.type?n._onCommand(e,r):"notification"===r.type?n._onNotification(r):"result"===r.type?n._onResult(r):void 0})),e.start(),t(e)}),r)}));this.ready=w.then((function(){}),(function(e){return n.dispose(),Promise.reject(e)})),this._signals=r}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach((function(e){e.resolve({result:"error",isExpected:!0,error:{code:G,message:"Messenger disposed"}})})),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:B,message:"disposed"}});var r=++z,i=t.timeoutDelayMs,o=void 0===i?this._resultTimeoutMs:i,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a;return this._port.then((function(t){var i=n._async,a=new Promise((function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout((function(){n._onResult(X(r,j))}),s),resultTimeout:i.setTimeout((function(){n._onResult(X(r,Z))}),o),resolve:e})}));return t.postMessage({type:"command",id:r,data:e}),a}))},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then((function(t){t.postMessage({type:"notification",data:e})}))},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then((function(t){e.postMessage({type:"result",data:t,id:n})})).catch((function(e){}))},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),r.delete(t)},e}();function X(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}var Q,Y={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},q=new Uint8Array(16);function $(){if(!Q&&!(Q="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Q(q)}for(var ee=[],te=0;te<256;++te)ee.push((te+256).toString(16).slice(1));function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(ee[e[t+0]]+ee[e[t+1]]+ee[e[t+2]]+ee[e[t+3]]+"-"+ee[e[t+4]]+ee[e[t+5]]+"-"+ee[e[t+6]]+ee[e[t+7]]+"-"+ee[e[t+8]]+ee[e[t+9]]+"-"+ee[e[t+10]]+ee[e[t+11]]+ee[e[t+12]]+ee[e[t+13]]+ee[e[t+14]]+ee[e[t+15]]).toLowerCase()}var re,ie=function(e,t,n){if(Y.randomUUID&&!t&&!e)return Y.randomUUID();var r=(e=e||{}).random||(e.rng||$)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return ne(r)},oe=((re={}).SHAREPOINT_TOKEN="SPO",re);var ae=function(){this.playState=new R(void 0),this.isPlayerReady=new R(!1)},se=function(){function e(e,t,n,r){this._ttlMs=new R(void 0),this._ttirMs=new R(void 0),this._playerInteractiveTimestamp=new R(void 0),this._latestValuesFromIframe={playState:void 0},this._crossWindow=e,this._tokenRetriever=t,this._embedUrl=n,this._onError=r,this.playbackApi=new ae,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp},this.subscribeToApiEvents()}return e.prototype.warmData=function(){return this._crossWindow.sendCommand({command:"one-player-warm-data"}).then((function(){return Promise.resolve()})).catch((function(e){throw new O("warning",!1,"warmData","warmDataUnknown",e)}))},e.prototype.loadPlayer=function(){return this._crossWindow.sendCommand({command:"one-player-load-player"}).then((function(){return Promise.resolve()})).catch((function(e){throw new O("fatal",!1,"loadPlayer","loadPlayerUnknown",e)}))},e.prototype.onCommand=function(e){if("getToken"===e.command)return function(e,t,n){return(0,M.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,M.__generator)(this,(function(c){switch(c.label){case 0:if(!Object.prototype.hasOwnProperty.call(oe,e.tokenType))return[3,4];r=e.tokenType,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t.getTokenAsync(oe[r],n)];case 2:return[2,{result:"success",token:c.sent()}];case 3:return i=c.sent(),o="",a="","object"===typeof i&&null!==i&&(s=i,o=Object.prototype.hasOwnProperty.call(s,"code")&&"string"===typeof s.code?s.code:"",a=Object.prototype.hasOwnProperty.call(s,"message")&&"string"===typeof s.message?s.message:""),[2,{result:"error",isExpected:!1,error:{code:o,message:a}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}}))}))}(e,this._tokenRetriever,this._embedUrl)},e.prototype.onNotification=function(e){switch(e.notification){case"one-player-first-interactive":if(e.timestamp&&e.timestampTimeOrigin){var t=e.timestampTimeOrigin-performance.timeOrigin;this._playerInteractiveTimestamp.value=t+e.timestamp}break;case"one-player-player-ready":this.playbackApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var n="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=n,this.playbackApi.playState.value=n,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||new O("fatal",!1,"playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||new O("fatal",!1,"createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi))}},e.prototype.subscribeToApiEvents=function(){var e=this;this.playbackApi.playState.subscribe((function(t){t&&t!==e._latestValuesFromIframe.playState&&e._crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch((function(t){e._onError(new O("warning",!1,"playback","enginePlayback",t,"could not send play/pause command"))}))}))},e}(),ce=function(){function e(e,t,n,r){if(this._channelId=ie(),this._onError=r,null===t.contentWindow)throw new Error("The iframe's contentWindow is null");var i=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*";this._embedUrl=e+"#channelId="+this._channelId+"&origin="+i,this._host=function(e,t){void 0===t&&(t={});var n=e.channelId,r=e.onReinitialize,i=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,c=e.identifyParent,u=t.eventGroupType,l=void 0===u?N:u,d=t.messengerType,p=void 0===d?J:d,h=new D,f=h.attach(new l(null));return new p({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(c&&s){var u=setInterval((function(){var e={type:"identify-parent",channelId:n};s.postMessage(e,i)}),100);o=h.attach({dispose:function(){clearInterval(u)}})}var l=!1;f.on(a,"message",(function(t){var a=t.data;if(t.origin===i&&(!s||t.source===s)&&a&&"object"===typeof a&&"initialize"===a.type&&a.channelId===n){if(o&&o.dispose(),r){if(l)return r(),void f.dispose();l=!0}else f.dispose();var c=a.replyTo;c.postMessage({type:"activate"}),e(c)}}))},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:t.contentWindow,channelId:this._channelId.toString(),origin:new URL(e).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this.iFrameApi=new se(this._host,n,this._embedUrl,this._onError),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)}return e.prototype.getDecoratedEmbedUrl=function(){return this._embedUrl},e.prototype.dispose=function(){this._host.dispose()},e.prototype.onCommand=function(e){return this._onCommandCallback(e)},e.prototype.onNotification=function(e){this._onNotificationCallback(e)},e}();function ue(e,t,n){return new Promise((function(r,i){e.onload=function(){r()},e.onerror=function(e){i(e)};var o=e.contentDocument;o.body||o.createElement("body");var a=o.createElement("form");a.action=t,a.method="POST",a.style.visibility="hidden",a.target="_self";var s=o.createElement("input");s.type="hidden",s.name="access_token",s.value=n,a.appendChild(s),o.body.appendChild(a),a.submit()}))}var le=function(){function e(e,t,n,r,i){var o=this;this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",i&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *";var a=this.onLoad.bind(this);this._iframe.addEventListener("load",a),this._embedUrl=e,this._containerDiv=t,this._tokenRetriever=n,this._onError=r,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this._disposeActions=[function(){o._iframe&&(o._containerDiv.removeChild(o._iframe),o._iframe.removeEventListener("load",a),o._iframe=void 0)}]}return e.prototype.loadAndConnectToOnePlayer=function(){return(0,M.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return(0,M.__generator)(this,(function(i){switch(i.label){case 0:if(void 0===this._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._tokenRetriever.getTokenAsync("SPO",this._embedUrl)];case 2:return e=i.sent(),[3,4];case 3:throw t=i.sent(),new O("fatal",!1,"loadIframe","getTokenFailed",t);case 4:this._crossWindowChannel=new ce(this._embedUrl,this._iframe,this._tokenRetriever,this._onError),this._disposeActions.push((function(){var e;return null===(e=r._crossWindowChannel)||void 0===e?void 0:e.dispose()})),this._embedUrl=this._crossWindowChannel.getDecoratedEmbedUrl(),i.label=5;case 5:return i.trys.push([5,7,,8]),[4,ue(this._iframe,this._embedUrl,e)];case 6:return i.sent(),[3,8];case 7:throw n=i.sent(),new O("fatal",!1,"loadIframe","navToEmbed",n);case 8:return[2,this._crossWindowChannel.iFrameApi]}}))}))},e.prototype.dispose=function(){for(var e=0,t=this._disposeActions;e<t.length;e++){(0,t[e])()}this._disposeActions.length=0},e.prototype.onLoad=function(){var e,t;try{"about:blank"===(null===(t=null===(e=this._iframe)||void 0===e?void 0:e.contentWindow)||void 0===t?void 0:t.location.href)&&(this._hasNavigatedToAboutBlank&&this._onError(new O("fatal",!1,"loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(n){}},e}(),de=function(){function e(e){this._loaderOptionsBase=e}return e.prototype.createPlaybackSession=function(e,t){return(0,M.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,M.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return n=a.sent(),r=n[0],i=n[1],[2,{playbackApi:r.playbackApi,dispose:i,playerStats:r.playerStats}];case 2:throw(o=a.sent())instanceof O?o:new O("fatal",!1,"loadIframe","iframeUnknown",o,void 0,t.hostSessionId);case 3:return[2]}}))}))},e.prototype.createDeferredPlaybackSession=function(e){return(0,M.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o;return(0,M.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("deferredLoad",e)];case 1:return t=a.sent(),n=t[0],r=t[1],i=new R(void 0),n.playbackApi.isPlayerReady.subscribe((function(e){e&&(i.value=n.playbackApi)})),[2,{playbackApi:i,loadPlayer:function(){return n.loadPlayer()},warmData:function(){return n.warmData()},dispose:r,playerStats:n.playerStats}];case 2:throw(o=a.sent())instanceof O?(o.hostSessionId=e.hostSessionId,o):new O("fatal",!1,"loadIframe","iframeUnknown",o,void 0,e.hostSessionId);case 3:return[2]}}))}))},e.prototype.createPlaybackSessionInternal=function(e,t){return(0,M.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,M.__generator)(this,(function(s){switch(s.label){case 0:return n={timeOrigin:performance.timeOrigin,timestamp:performance.now()},[4,this.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return r=s.sent(),r=this.adjustEmbedUrlQueryString(e,r,t,n),i=void 0,o=function(){try{null===i||void 0===i||i.dispose()}catch(e){throw e instanceof O?e:new O("fatal",!1,"dispose","disposeUnknown",e,void 0,t.hostSessionId)}},a=function(e){t.onError(o,e)},[4,(i=new le(r,t.containerDiv,this._loaderOptionsBase.tokenRetriever,a,t.allowFullscreen)).loadAndConnectToOnePlayer()];case 2:return[2,[s.sent(),o]]}}))}))},e}(),pe=function(e){function t(t){return e.call(this,t)||this}return(0,M.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,n,r){var i,o,a=new URL(t);a.searchParams.delete("access_token"),a.searchParams.set("auth","readwrite");var s=JSON.stringify({ha:n.hostApp,hp:n.hostPlatform,hv:n.hostView,hm:n.hostMode,hsi:n.hostSessionId,he:n.hostEnvironment,hc:n.hostComponent,hci:n.hostCorrelationId,het:n.hostExtraTelemetry,hra:n.hostReferrerApp,hrp:n.hostReferrerAppPlatform,hrv:n.hostReferrerView,hrm:n.hostReferrerMode,hrps:n.hostReferrerPlaybackSessionId,hvn:n.hostVersion,t0:n.hostTimestamps.t0.timestamp,t0to:n.hostTimestamps.t0.timeOrigin,tcs:r.timestamp,tcsto:r.timeOrigin,dl:"deferredLoad"===e?1:void 0,af:"autoplayOn"===e?1:void 0,thm:null===(i=n.theme)||void 0===i?void 0:i.name,pc:null===(o=n.theme)||void 0===o?void 0:o.primaryColor,ol:n.overrideLanguage,hvm:n.hideVideoMetadata,itf:n.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(a.searchParams.set("embed",s),n.startTimeInSeconds){var c={playbackOptions:{startTimeInSeconds:n.startTimeInSeconds}};a.searchParams.set("nav",JSON.stringify(c))}return a.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("streamembed.aspx"))return Promise.resolve(e);throw new O("fatal",!1,"loadIframe","unrecognizedVideoUrlFormat",void 0,void 0)},t}(de);var he=function(e){function t(t){return e.call(this,t)||this}return(0,M.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,n,r){var i=new URL(t);i.searchParams.delete("access_token"),i.searchParams.set("auth","readwrite");var o=void 0,a=void 0;n.theme&&(o="light"===n.theme.name?1:0,a=n.theme.primaryColor);var s=JSON.stringify({af:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:n.hostApp,hp:n.hostPlatform,hv:n.hostView,hc:n.hostComponent,hm:n.hostMode,hsi:n.hostSessionId,t0:n.hostTimestamps.t0.timestamp,t0to:n.hostTimestamps.t0.timeOrigin,tcs:r.timestamp,tcsto:r.timeOrigin,ust:o,pc:a,ol:n.overrideLanguage,hvm:n.hideVideoMetadata,itf:n.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(i.searchParams.set("embed",s),n.startTimeInSeconds){var c={playbackOptions:{startTimeInSeconds:n.startTimeInSeconds}};i.searchParams.set("nav",JSON.stringify(c))}return i.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw new O("fatal",!1,"loadIframe","unrecognizedVideoUrlFormat",void 0)},t}(de);var fe=n(77482),me={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGE_CHROMIUM:"Edge Chromium",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},ve="Windows",ye="Mac OS X",be="Windows Phone",_e="Windows RT",we="iOS",ge="Android",ke="Linux",Ee=/(windows|win32)/i,Se=/ arm;/i,Pe=/windows\sphone\s\d+\.\d+/i,Te=/(macintosh|mac os x)/i,Ie=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Oe=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Me=/android/i,Ce={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Ae="([\\d,.]+)",Re="Unknown",Ue="undefined";function xe(e,t){return t.indexOf(e)>-1}function De(e,t){return t===me.MSIE?function(e){var t=e.match(new RegExp(me.MSIE+" "+Ae));if(t)return t[1];var n=e.match(new RegExp("rv:"+Ae));if(n)return n[1];return""}(e):function(e,t){var n=e;n===me.SAFARI&&(n="Version");var r=t.match(new RegExp(n+"/"+Ae));if(r)return r[1];return}(t===me.EDGE_CHROMIUM?"Edg":t,e)}var Ne=function(e){return e.match(Pe)?be:e.match(Se)?_e:e.match(Ie)?we:e.match(Me)?ge:e.match(Oe)?ke:e.match(Te)?ye:e.match(Ee)?ve:Re},Fe=function(e,t){return t===ve?Le(e,"Windows NT"):t===ge?Le(e,t):t===ye?Ve(e):Re},Le=function(e,t){var n=e.match(new RegExp(t+" "+Ae));return n?Ce[n[1]]?Ce[n[1]]:n[1]:Re},Ve=function(e){var t=e.match(new RegExp(ye+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}(n);return r?n.split(r)[0]:n}}return Re},We=void 0;function He(){if(!We){var e=typeof navigator!==Ue?navigator.userAgent:"",t=function(e){return xe("OPR/",e)?me.OPERA:xe(me.PHANTOMJS,e)?me.PHANTOMJS:xe(me.EDGE,e)?me.EDGE:xe("Edg",e)?me.EDGE_CHROMIUM:xe(me.ELECTRON,e)?me.ELECTRON:xe(me.CHROME,e)?me.CHROME:xe("Trident",e)?me.MSIE:xe(me.FIREFOX,e)?me.FIREFOX:xe(me.SAFARI,e)?me.SAFARI:xe(me.SKYPE_SHELL,e)?me.SKYPE_SHELL:void 0}(e),n=void 0!==t?De(e,t):void 0,r=Ne(e),i=void 0!==r?Fe(e,r):void 0;We={browserName:t,browserVersion:n,osName:r,osVersion:i}}return We}var je=function(){return"undefined"===typeof window},Ze=function(){var e;return!(null===(e=window.chrome)||void 0===e||!e.webview)};function Ke(){return function(e){if(je()||Ze())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(He().osName)}var Ge=n(26934);function Be(e){var t,n,r=null!==(t=Ke())&&void 0!==t?t:"Native",i=Ge.H3[e];if(void 0===i){var o=e;return"d3590ed6-52b3-4102-aeff-aad2292ab01c"===e&&(o="Win32"===r?"Outlook":"Loop"),{hostApp:o,hostPlatform:r}}return{hostApp:i.hostApp,hostPlatform:null!==(n=i.hostPlatform)&&void 0!==n?n:r}}var ze=n(82519);function Je(e){return function(t){"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}function Xe(e,t){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,S.Z)((0,E.Z)().mark((function e(t,n){var r;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={beginSilentSignOn:function(){},getTokenAsync:function(){var e=(0,S.Z)((0,E.Z)().mark((function e(r,i){var o,a,s,c;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return[],e.prev=1,null===n||void 0===n||n.markSubActivityStart(y.u.OnePlayerTokenRetrieval),a=P.v.SharePoint,o=(0,T.B)((0,I.P)(i),a),e.next=7,t.TokenProvider.getToken(o);case 7:return s=e.sent,null===n||void 0===n||n.markSubActivityEnd(y.u.OnePlayerTokenRetrieval),e.abrupt("return",s.token);case 12:throw e.prev=12,e.t0=e.catch(1),null===n||void 0===n||n.markSubActivityEnd(y.u.OnePlayerTokenRetrieval,(c={},(0,f.Z)(c,u.KF.OnePlayerTokenRetrieval,"failed"),(0,f.Z)(c,"tokenType",r),c)),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()},e.abrupt("return",{tokenRetriever:r});case 2:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}function Ye(){return Ye=(0,S.Z)((0,E.Z)().mark((function e(t,n,r,i,o,a,s){var c,u,l,d,p,h,f,m,v,_,w,g,k=arguments;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=k.length>7&&void 0!==k[7]&&k[7],p=Be(null!==(c=r.AppID)&&void 0!==c?c:""),h=p.hostApp,f=p.hostPlatform,m=!1,v=b(i),e.next=6,Xe(r,v);case 6:return _=e.sent,w={videoId:{videoUrl:(0,ze.kL)(i.settingsProvider)||(0,ze.W0)(i.settingsProvider)?n.replace("embed.aspx","streamembed.aspx"):n},containerDiv:t,allowFullscreen:!0,onError:a,hostApp:h,hostPlatform:f,hostComponent:fe._,hostView:"",theme:o,hostSessionId:(null===(u=i.telemetryConfig)||void 0===u?void 0:u.hostSessionId)||"",hostMode:void 0,hostEnvironment:m?"Dev":"Prod",hostTimestamps:{t0:{timestamp:d?performance.now():null!==(l=null===v||void 0===v?void 0:v.startTime)&&void 0!==l?l:performance.now(),timeOrigin:performance.timeOrigin}},overrideLanguage:s,enableVideoPlayerTabstopDuringPlayback:!1},null===v||void 0===v||v.markSubActivityEnd(y.u.TimeInPlaybackLoopComponent),g=qe(_,i.settingsProvider),e.next=12,$e(g,w,i.settingsProvider);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)}))),Ye.apply(this,arguments)}function qe(e,t){return(0,ze.kL)(t)||(0,ze.W0)(t)?function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new pe(e)}catch(n){throw n instanceof O?n:new O("fatal",!1,"loadIframe",t,n)}}(e):function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new he(e)}catch(n){throw n instanceof O?n:new O("fatal",!1,"loadIframe",t,n)}}(e)}function $e(e,t,n){return(0,ze.W0)(n)?e.createDeferredPlaybackSession(t):e.createPlaybackSession(!1,t)}var et=function(e){var t,n=e.embeddableUrl,f=e.playbackStateSetter,m=e.parentRef,E=e.setViewRootElement,S=e.endRenderingActivity,P=e.onKeyDownHandler,T=e.setIsPlayerReady,I=e.strings,O=(0,d.w)(),M=(0,p.I)(),C=(0,h.j)(),A=o.useRef(null),R=o.useRef(null),U=o.useRef(null),x=o.useRef(null),D=o.useState(!1),N=(0,i.Z)(D,2),F=N[0],L=N[1],V="dark"===(null===(t=(0,a.u)())||void 0===t?void 0:t.themeName)?"dark":"light",W=(0,s.bU)(),H=o.useMemo(v,[]),j=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=o.useState(!1),r=(0,i.Z)(n,2),a=r[0],s=r[1],l=o.useRef(),p=(0,d.w)();return o.useEffect((function(){if(t){var e=new IntersectionObserver((function(e){s(e[0].isIntersecting)}));return l.current=e,function(){return e.disconnect()}}}),[t]),o.useEffect((function(){if(t){var n=e.current;if(n){if(l.current){var r=l.current;return r.observe(n),function(){return r.unobserve(n)}}return function(){}}(0,c.S)(void 0,p,"useVisibilityObserver",u.KF.MissingVisibilityElement)}}),[e,p,t]),{observer:l,isVisible:a}}(m,(0,ze.W0)(M.settingsProvider)),Z=o.useCallback((function(e){var t=b(M);t&&e&&(null===T||void 0===T||T(!0),H.setIsReady(t,{playerInteractiveTimestamp:e}))}),[M,H,T]),K=o.useCallback((function(e){!function(e){return _.includes(e.key)}(e)?function(e){return w.includes(e.key)}(e)||P(e):(e.preventDefault(),e.stopPropagation(),"Playing"===f.getPlaybackState()?f.pause():f.play())}),[f,P]),G=o.useCallback((function(){(0,k.X6)(m.current)}),[m]),B=o.useCallback((function(){(0,k.hN)(m.current)}),[m]),z=o.useCallback((function(e){f.initialize(e),U.current=(0,r.Z)((0,r.Z)({},U.current),{},{playStateUnsubscribe:e.playState.subscribe(Je(f))})}),[f]);return o.useEffect((function(){if(x.current){var e,t=x.current;if(g(t)&&j.isVisible&&m.current)null===(e=j.observer.current)||void 0===e||e.unobserve(m.current),t.warmData().catch((function(e){(0,c.S)(e,O,"warmData",u.KF.OnePlayerWarmup)}))}}),[j,O,m,F]),o.useEffect((function(){var e=b(M),t=function(t,n){null===T||void 0===T||T(!0);var i=n.level,o=n.isExpected,a=n.scenario,s=n.knownError;"iframeForciblyUnloaded"===s?(x.current=null,t(),null===e||void 0===e||e.markSubActivityStart(y.u.SetupIframeAfterIframeForciblyUnloaded),r(),null===e||void 0===e||e.markSubActivityEnd(y.u.SetupIframeAfterIframeForciblyUnloaded)):(S(l.G.Embedded),null===e||void 0===e||e.setResult(!1,{errorCode:u.KF.IframePlayerSetup,level:i,scenario:a,isExpected:o},s))};function r(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];""!==n&&null!==A.current&&(A.current.isConnected?function(e,t,n,r,i,o,a){return Ye.apply(this,arguments)}(A.current,n,C,M,{name:V},t,W,i).then((function(e){S(l.G.Embedded),x.current=e,L(!0),E(R.current),U.current={playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe(Z)},g(e)?e.playbackApi.subscribe((function(e){e&&z(e)})):z(e.playbackApi)})).catch((function(t){null===T||void 0===T||T(!0),S(l.G.Embedded),null===e||void 0===e||e.setResult(!1,{errorCode:u.KF.IframePlayerSetup},t),(0,c.S)(t,O,"setupIframePlayer",u.KF.IframePlayerSetup)})):function(e,t,n){null===n||void 0===n||n.markSubActivityStart(y.u.VideoHydratedInDetachedMode);var r=document.createElement("iframe");r.height="0px",r.width="0px",r.style.visibility="hidden";var i=function i(){e.removeChild(r),null===n||void 0===n||n.markSubActivityEnd(y.u.VideoHydratedInDetachedMode),t(!0),document.removeEventListener("load",i),document.removeEventListener("error",i)};r.addEventListener("load",i),r.addEventListener("error",i),e.appendChild(r)}(A.current,r,e))}return r(),function(){var e,t;U.current&&(t=U.current,Object.values(t).forEach((function(e){return e()}))),null===(e=x.current)||void 0===e||e.dispose()}}),[n,C,O,M,f,S,V,E,Z,H,K,W,z,T]),o.createElement(o.Fragment,null,o.createElement("div",{ref:R,role:"link",tabIndex:0,onFocus:G,onBlur:B,onKeyDown:K,"aria-label":I.onePlayerIframeHostContainerAriaLabel}),o.createElement("div",{ref:A,className:k.ap,"aria-label":I.onePlayerIframeHostContainerAriaLabel}))}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.88d893d4.chunk.js.map