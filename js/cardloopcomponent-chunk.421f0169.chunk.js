/*! For license information please see cardloopcomponent-chunk.421f0169.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[4492],{20112:function(e,t,r){r.d(t,{C:function(){return i},R:function(){return o}});var n=r(72791),a=(0,n.createContext)({setAppStatus:function(){},setCardData:function(){},setMessageData:function(){},setVerificationStatus:function(){}}),i=a.Provider,o=function(){return(0,n.useContext)(a)}},94577:function(e,t,r){r.d(t,{R:function(){return s},U:function(){return o}});var n=r(72791),a={cardData:{appId:"",cardId:"",appName:"Unknown",verificationStatus:"Unknown",registrationId:"",cardType:"application/vnd.microsoft.card.adaptive",payload:{}},cardDataHandler:void 0,isVerificationRequired:!1,appStatus:"Unknown"},i=(0,n.createContext)(a),o=i.Provider,s=function(){return(0,n.useContext)(i)}},72341:function(e,t,r){r.d(t,{n:function(){return i},v:function(){return o}});var n=r(72791),a=(0,n.createContext)({}),i=a.Provider,o=function(){return(0,n.useContext)(a)}},84398:function(e,t,r){r.d(t,{o:function(){return o},u:function(){return i}});var n=r(72791),a=(0,n.createContext)({}),i=a.Provider,o=function(){return(0,n.useContext)(a)}},80111:function(e,t,r){r.d(t,{T:function(){return u},z:function(){return s}});var n=r(86359),a=r(72791),i={name:"Light",theme:(0,n.X)(void 0)},o=(0,a.createContext)(i),s=o.Provider,u=function(){return(0,a.useContext)(o)}},37837:function(e,t,r){r.d(t,{S:function(){return a}});var n=r(72422),a=function(e,t,r){var a=void 0;switch(t){case"Unknown":a={message:(0,n.E)("Card actionability is disabled as card verification is in progress, please wait and retry again."),messageType:"info",dismissType:"auto",actionProps:r};break;case"Failed":a={message:(0,n.E)("Card actionability is disabled as card verification failed."),messageType:"error",dismissType:"auto",actionProps:r};break;case"Error":a={message:(0,n.E)("Card actionability is disabled as card can't be verified now. Please wait and retry again."),messageType:"info",dismissType:"auto",actionProps:r}}switch(e){case"Error":case"Unknown":a={message:(0,n.E)("Card actionability is disabled as app is not available. Please contact your tenant admin."),messageType:"error",dismissType:"auto",actionProps:r};break;case"NotAvailable":a={message:(0,n.E)("Card actionability is disabled as app is not available for this tenant."),messageType:"error",dismissType:"auto",actionProps:r};break;case"NotInstalled":a={message:(0,n.E)("Card actionability is disabled as app is not installed."),messageType:"error",dismissType:"auto",actionProps:r}}return a}},72422:function(e,t,r){r.d(t,{E:function(){return a}});var n=r(72791),a=function(e){return n.createElement("div",null,e)}},86359:function(e,t,r){r.d(t,{X:function(){return u}});var n=r(29439),a=r(37762),i=r(59020),o="--ms-themeColorPalette",s="--ms-themeColor";function u(e){var t=void 0;if(e){t=[];var r,u=(0,a.Z)(e);try{for(u.s();!(r=u.n()).done;){var c=(0,n.Z)(r.value,2),l=c[0],v=c[1];t.push({name:l,value:v})}}catch(x){u.e(x)}finally{u.f()}}var p={},h={},f=(0,i.j)(),g=function(e,t){if(e.startsWith(o)){var r=function(e){var t="--ms-themeColorPaletteShared",r="--ms-themeColorPaletteAccent";if(e.startsWith(t))return d(e,t);if(e.startsWith(r))return d(e,r);if(e.startsWith(o))return d(e,o);return}(e);void 0!==r&&f.palette.hasOwnProperty(r)&&!p[r]&&(p[r]=t)}else if(e.startsWith(s)){var n=d(e,s);n&&f.semanticColors.hasOwnProperty(n)&&!h[n]&&(h[n]=t)}};if(t){var m,y=(0,a.Z)(t);try{for(y.s();!(m=y.n()).done;){var C=m.value;g(C.name,C.value)}}catch(x){y.e(x)}finally{y.f()}}return(0,i.j)({palette:p,semanticColors:h})}function d(e,t){var r=e.substring(t.length);return"".concat(r.substring(0,1).toLowerCase()).concat(r.substring(1))}},10759:function(e,t,r){r.d(t,{u:function(){return i},y:function(){return a}});var n=r(37837),a=function(e,t,r,a,o,s){var u;s(null!==(u=(0,n.S)(t,r,i(e,t,a,o)))&&void 0!==u?u:{message:null,messageType:"info",dismissType:"auto"})};function i(e,t,r,n){if("Installed"!==t)return{message:"Install",onClick:function(){var t;null===(t=r.installApp)||void 0===t||t.call(r,e).then((function(e){n(e)})).catch((function(){}))}}}},62827:function(e,t,r){r.d(t,{F:function(){return u}});var n=r(80111),a=r(72791),i=r(3717),o=r(42110),s=(0,i.NF)((function(e){return(0,o.ZC)({container:{color:"Light"===e?"#1e1e1e":"#f1f1f1"}})})),u=function(e){var t=e.message,r=(0,n.T)().name;return a.createElement("div",{className:s(r).container},t)}},19202:function(e,t,r){r.r(t),r.d(t,{loopExport:function(){return ft}});var n=r(74165),a=r(29439),i=r(15671),o=r(43144),s=r(75971),u=r(30957),d=r(96914),c=r(11012);function l(e,t,r,n){var a,i;return{"UserInfo.Id":null===(a=null===e||void 0===e?void 0:e.user)||void 0===a?void 0:a.id,tenantId:null===(i=null===e||void 0===e?void 0:e.user)||void 0===i?void 0:i.tenantId,hostName:null===e||void 0===e?void 0:e.hostName,hostSessionId:null===e||void 0===e?void 0:e.hostSessionId,hostAppVersion:null===e||void 0===e?void 0:e.hostAppVersion,hostCorrelationId:null===e||void 0===e?void 0:e.hostCorrelationId,physicalRing:null===e||void 0===e?void 0:e.audience,correlationId:t,hostLocale:null===e||void 0===e?void 0:e.uiLocale,hostAppName:null===e||void 0===e?void 0:e.hostAppName,hostAppPlatform:null===e||void 0===e?void 0:e.hostAppPlatform,dataSource:r,isMeRendererEnabled:n}}var v,p=function(){function e(t){(0,i.Z)(this,e),this.activity=t}return(0,o.Z)(e,[{key:"end",value:function(e){this.activity.success=null===e||void 0===e||e,this.activity.endNow()}}]),e}(),h="Office.Fluid.CardLoop",f="ed981353800d49a1bacb17544b041351-8dd69ad5-1613-406c-a20a-9426ff93b8d6-7071",g="Office.Fluid.CardLoop.OTelJS.",m="Success",y="Error",C="Perf",x=g+m+".",b=g+y+".",k=g+C+".",w=(r(82732),r(95244));function P(e){return function(e){if(v)return v;return v=S(),null===e||void 0===e||e.then((function(e){e&&(v.addSink(e),v.flushQueue())})),v}(e)}function S(){var e=new w.h(void 0,void 0,{enableQueue:!0});return e.setTenantToken(h,f),e}var E=function(){function e(t,r,n){(0,i.Z)(this,e),this.dataSource=t,this.isMERendererEnabled=!1,this.dataSource=t,this.telemetryLogger=P(r),this._correlationId=null!==n&&void 0!==n?n:(0,u.pW)()}return(0,o.Z)(e,[{key:"logEvent",value:function(e,t,r){var n=l(this._loopContext,this._correlationId,this.dataSource,this.isMERendererEnabled),i="error"===e?b:x,o="error"===e?[r,void 0]:[void 0,r],s=(0,a.Z)(o,2),u=s[0],v=s[1],p=this.mapEventPropertiesToDataFields(n);u&&p.push((0,d.dt)("errorMessage",u)),v&&p.push((0,d.dt)("eventMetaData",v));var h={eventName:i+t,dataFields:p,eventFlags:{diagnosticLevel:c.K.DiagnosticLevel.RequiredServiceData,samplingPolicy:c.K.SamplingPolicy.CriticalUsage,dataCategories:c.K.DataCategories.ProductServiceUsage}};this.telemetryLogger.sendTelemetryEvent(h)}},{key:"startPerfEvent",value:function(e){var t=l(this._loopContext,this._correlationId,this.dataSource,this.isMERendererEnabled),r=this.mapEventPropertiesToDataFields(t),n=this.telemetryLogger.createActivity({eventName:k+e,dataFields:r,eventFlags:{diagnosticLevel:c.K.DiagnosticLevel.RequiredServiceData,samplingPolicy:c.K.SamplingPolicy.CriticalUsage,dataCategories:c.K.DataCategories.ProductServicePerformance}});return new p(n)}},{key:"LoopContext",set:function(e){this._loopContext=e}},{key:"loopContext",get:function(){return this._loopContext}},{key:"IsM365CardRendererEnabled",set:function(e){this.isMERendererEnabled=e}},{key:"correlationId",get:function(){return this._correlationId}},{key:"mapEventPropertiesToDataFields",value:function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(a){var i=e[a];switch(typeof i){case"number":t.push((0,d.b_)(a,i));break;case"string":t.push((0,d.dt)(a,i));break;case"boolean":t.push((0,d.UL)(a,i))}}}return t}}]),e}(),A=function(){function e(t,r){var a=this;(0,i.Z)(this,e),this.MetaOSProvider=t,this.logger=r,this.MetaOSProvider.getAppStatus&&(this.getAppStatus=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.GetAppStatus"),t.prev=1,t.next=4,this.MetaOSProvider.getAppStatus(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.MetaOSProvider.openAuthOrConfig&&(this.openAuthOrConfig=function(e,t){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function r(){var a,i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=this.logger.startPerfEvent("MetaOSProvider.OpenAuthOrConfig"),r.prev=1,r.next=4,this.MetaOSProvider.openAuthOrConfig(e,t);case 4:return i=r.sent,a.end(!0),r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(1),a.end(!1),r.t0;case 13:case"end":return r.stop()}}),r,this,[[1,9]])})))}),this.MetaOSProvider.handleAuth&&(this.handleAuth=function(e,t,r){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function a(){var i,o;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.logger.startPerfEvent("MetaOSProvider.HandleAuth"),n.prev=1,n.next=4,this.MetaOSProvider.handleAuth(e,t,r);case 4:return o=n.sent,i.end(!0),n.abrupt("return",o);case 9:throw n.prev=9,n.t0=n.catch(1),i.end(!1),n.t0;case 13:case"end":return n.stop()}}),a,this,[[1,9]])})))}),this.MetaOSProvider.openAuth&&(this.openAuth=function(e,t,r){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function a(){var i,o;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.logger.startPerfEvent("MetaOSProvider.OpenAuth"),n.prev=1,n.next=4,this.MetaOSProvider.openAuth(e,t,r);case 4:return o=n.sent,i.end(!0),n.abrupt("return",o);case 9:throw n.prev=9,n.t0=n.catch(1),i.end(!1),n.t0;case 13:case"end":return n.stop()}}),a,this,[[1,9]])})))}),this.MetaOSProvider.installApp&&(this.installApp=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.InstallApp"),t.prev=1,t.next=4,this.MetaOSProvider.installApp(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.MetaOSProvider.openLaunchPage&&(this.openLaunchPage=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.OpenLaunchPage"),t.prev=1,t.next=4,this.MetaOSProvider.openLaunchPage(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.MetaOSProvider.openTaskModule&&(this.openTaskModule=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.OpenTaskModule"),t.prev=1,t.next=4,this.MetaOSProvider.openTaskModule(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.MetaOSProvider.openStageView&&(this.openStageView=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.OpenStageView"),t.prev=1,t.next=4,this.MetaOSProvider.openStageView(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))})}return(0,o.Z)(e,[{key:"getAppDefinition",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.GetAppDefinition"),t.prev=1,t.next=4,this.MetaOSProvider.getAppDefinition(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}},{key:"getAppInstalledStatus",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("MetaOSProvider.GetAppInstalledStatus"),t.prev=1,t.next=4,this.MetaOSProvider.getAppInstalledStatus(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}}]),e}(),I=function(){function e(t,r){var a=this;(0,i.Z)(this,e),this.CardChannelProvider=t,this.logger=r,this.CardChannelProvider.getUnfurlableDomains&&(this.getUnfurlableDomains=function(){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.logger.startPerfEvent("CardChannelProvider.GetUnfurlableDomains"),e.prev=1,e.next=4,this.CardChannelProvider.getUnfurlableDomains();case 4:return r=e.sent,t.end(!0),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),t.end(!1),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}),this.CardChannelProvider.executeAdaptiveCardAction&&(this.executeAdaptiveCardAction=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("CardChannelProvider.ExecuteAdaptiveCardAction"),t.prev=1,t.next=4,this.CardChannelProvider.executeAdaptiveCardAction(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.CardChannelProvider.verifyCard&&(this.verifyCard=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("CardChannelProvider.VerifyCard"),t.prev=1,t.next=4,this.CardChannelProvider.verifyCard(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}),this.CardChannelProvider.botInvoke&&(this.botInvoke=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.logger.startPerfEvent("CardChannelProvider.BotInvoke"),t.prev=1,t.next=4,this.CardChannelProvider.botInvoke(e);case 4:return a=t.sent,r.end(!0),t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(1),r.end(!1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))})}return(0,o.Z)(e,[{key:"unfurl",value:function(e,t,r,a){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function i(){var o,s;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=this.logger.startPerfEvent("CardChannelProvider.Unfurl"),n.prev=1,n.next=4,this.CardChannelProvider.unfurl(e,t,r,a);case 4:return s=n.sent,o.end(!0),n.abrupt("return",s);case 9:throw n.prev=9,n.t0=n.catch(1),o.end(!1),n.t0;case 13:case"end":return n.stop()}}),i,this,[[1,9]])})))}}]),e}(),D="--ms-themeColorThemeName";function Z(e){return"dark"===(null===e||void 0===e?void 0:e.get(D))?"Dark":"Light"}var T=function(e,t){var r,n=null===(r=null===e||void 0===e?void 0:e.payload.metadata)||void 0===r?void 0:r.webUrl;if("undefined"!==typeof n)try{return{url:new URL(n)}}catch(a){return void t.logEvent("error","MalFormedUrlInCardMetadata")}else t.logEvent("error","NoUrlInCardMetadata")},M=function(){function e(){(0,i.Z)(this,e),this._isInFocus=!1}return(0,o.Z)(e,[{key:"parentDiv",get:function(){return this._parentDiv},set:function(e){var t=this;e&&(this._parentDiv=e,this._parentDiv.tabIndex=0,this._parentDiv.addEventListener("keydown",(function(e){var r,n;if("Escape"===e.key){null===(r=t.moveFocusToHostCallback)||void 0===r||r.call(t);var a=null===(n=t._hostComponent)||void 0===n?void 0:n.ComponentFocusable;a&&a.giveFocus()&&(t._isInFocus=!1)}})))}},{key:"hostComponent",set:function(e){this._hostComponent=e}},{key:"isInFocus",get:function(){return this._isInFocus}},{key:"focusDirection",get:function(){return this._focusDirection}},{key:"setFocus",value:function(e,t){var r;this._isInFocus=e,this._focusDirection=t,e&&(null===(r=this._parentDiv)||void 0===r||r.focus({preventScroll:!0}))}}]),e}(),_=r(15861);var U=function(){function e(t,r,n){(0,i.Z)(this,e),this.value=t,this.path=r,this.routeContext=n,this.pendingHandlesToMakeVisible=new Set,this.locallyVisible=!1,this.absolutePath=function(e,t){if(""===e)return void 0===t?"":t.absolutePath;var r=e.startsWith("/")?e.slice(1):e;return r=r.endsWith("/")?r.slice(0,-1):r,void 0===t?"/".concat(r):"".concat("/"===t.absolutePath?"":t.absolutePath,"/").concat(r)}(r,this.routeContext)}return(0,o.Z)(e,[{key:"IFluidHandle",get:function(){return this}},{key:"isAttached",get:function(){return this.routeContext.isAttached}},{key:"visible",get:function(){return this.isAttached||this.locallyVisible}},{key:"get",value:function(){var e=(0,_.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.value);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"attachGraph",value:function(){this.visible||(this.locallyVisible=!0,this.pendingHandlesToMakeVisible.forEach((function(e){e.attachGraph()})),this.pendingHandlesToMakeVisible.clear(),this.routeContext.attachGraph())}},{key:"bind",value:function(e){this.visible?e.attachGraph():this.pendingHandlesToMakeVisible.add(e)}}]),e}(),O=Symbol("isProxy");var R=function(){function e(t,r,n,a){(0,i.Z)(this,e),this.contractCache=new Map([]),this.contractAdapterFactoryMap=new Map(r.map((function(e){return[e.key,e.factory]}))),this.proxyComponent=new Proxy(t,this),n&&void 0!==a&&this.setUpProxyFluidComponentHandle(n,a)}return(0,o.Z)(e,[{key:"getProxy",value:function(){return this.proxyComponent}},{key:"getProxyState",value:function(){return void 0===this.proxyState&&(this.proxyState={proxyComponent:this.proxyComponent}),this.proxyState}},{key:"get",value:function(e,t,r){if(t===O)return!0;if(t in e){var n=this.getProxyFluidComponentHandle(t);return n||Reflect.get(e,t,r)}return this.contractGetTrap(e,t)}},{key:"getProxyFluidComponentHandle",value:function(e){return"IFluidLoadable"===e&&this.proxyIFluidLoadable?this.proxyIFluidLoadable:"IFluidHandle"!==e&&"handle"!==e||!this.proxyFluidComponentHandle?void 0:this.proxyFluidComponentHandle}},{key:"setUpProxyFluidComponentHandle",value:function(e,t){this.proxyFluidComponentHandle=new U(this.proxyComponent,t,e.objectsRoutingContext);var r=this.proxyFluidComponentHandle;this.proxyIFluidLoadable={get IFluidLoadable(){return this},get handle(){return r}}}},{key:"contractGetTrap",value:function(e,t){if(this.contractCache.has(t))return this.contractCache.get(t);var r=this.contractAdapterFactoryMap.get(t);if(r){var n=r(e,this.getProxyState());return n&&this.contractCache.set(t,n),n}}},{key:"getOwnPropertyDescriptor",value:function(e,t){if("[[Target]]"===t)return{configurable:!0,enumerable:!0,value:e}}}]),e}();function L(e,t){var r=t&&t.length>0?function(e,t){return new R(e,t).getProxy()}(e,t):e;return r}var N=function(){function e(t,r,n){(0,i.Z)(this,e),this.ctor=t,this.optionalProviders=r,this.contractAdapters=n,this.type="LoopObject"}return(0,o.Z)(e,[{key:"instantiateLoopComponent",value:function(){var e=(0,_.Z)((0,n.Z)().mark((function e(t,r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.optionalProviders&&(null===r||void 0===r?void 0:r.synthesize(this.optionalProviders,void 0))||void 0,e.abrupt("return",L(new this.ctor(t,a),this.contractAdapters));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function B(e){var t,r,n;return null!==(n=null===(r=null===(t=e.inputExtensions)||void 0===t?void 0:t[0])||void 0===r?void 0:r.botId)&&void 0!==n?n:void 0}var H=function(){function e(){(0,i.Z)(this,e),this._registryData=new Map,this._registryData.clear()}return(0,o.Z)(e,[{key:"getAppRegistryDataWithProviderPromise",value:function(e,t,r){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function a(){var i;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&t){n.next=2;break}return n.abrupt("return",Promise.resolve(void 0));case 2:return n.next=4,t;case 4:return i=n.sent,n.abrupt("return",this.getAppRegistryData(e,i,r));case 6:case"end":return n.stop()}}),a,this)})))}},{key:"getAppRegistryData",value:function(e,t,r){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function a(){var i,o,s;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",Promise.resolve(void 0));case 2:if(!this._registryData.has(e)){n.next=4;break}return n.abrupt("return",this._registryData.get(e));case 4:if(t){n.next=6;break}return n.abrupt("return",Promise.resolve(void 0));case 6:return i=new A(t,r),n.prev=7,n.next=10,i.getAppDefinition(e);case 10:return o=n.sent,s={displayName:o.name,icon:o.largeImageUrl,botId:B(o)},this._registryData.set(e,s),n.abrupt("return",Promise.resolve(s));case 16:return n.prev=16,n.t0=n.catch(7),n.abrupt("return",Promise.resolve(void 0));case 19:case"end":return n.stop()}}),a,this,[[7,16]])})))}}],[{key:"getInstance",value:function(){return this.INSTANCE||(this.INSTANCE=new e),this.INSTANCE}}]),e}().getInstance(),F="@1js/card-loop",q="application/vnd.microsoft.card.adaptive",V="application/vnd.microsoft.card.hero",W="application/vnd.microsoft.card.thumbnail",j="application/vnd.microsoft.teams.card.o365connector",G="SignInCard",z="JITInstallCard",J=function(e,t){if("URL"===e.dataType){var r=e.manifestData;return{initialSource:"URL",urlData:e.data,appId:null===r||void 0===r?void 0:r.SourceMetadata.MetaOsAppId,botId:null===r||void 0===r?void 0:r.SourceMetadata.MsaAppId,shouldEmbedData:!0,shouldVerifyCard:!1}}var n=e.data,a=function(e,t){return e.webUrl?{url:e.webUrl}:T(e,t)}(n,t);return n.webUrl||(n.webUrl=null===a||void 0===a?void 0:a.url),{initialSource:"Card",urlData:a,cardData:n,appId:n.appId,botId:n.botId,appName:n.appName,shouldEmbedData:!1,shouldVerifyCard:!!n.shouldVerifyCard}},Y=function(e,t){e.appName=t},Q="en-us",K=r(77578),X=r(55759),$=r(41655),ee=r(35585),te="https://substrate.office.com/search/SubstrateSearch-Internal.ReadWrite",re=(0,o.Z)((function e(t,r){var a=this;(0,i.Z)(this,e),this.tokenProvider=t,this.loopContext=r,this.getInvokeRequestUrl=function(){var e,t,r=null!==(t=null===(e=a.loopContext)||void 0===e?void 0:e.uiLocale)&&void 0!==t?t:Q;return"".concat("https://substrate.office.com/search/api/v1/botinvoke","?culture=").concat(r)},this.getInvokeRequestHeaders=function(){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new Headers).set("Content-Type","application/json"),e.prev=2,e.next=5,this.tokenProvider.getToken([te]);case 5:return(r=e.sent)&&t.set("Authorization","Bearer ".concat(r.token)),e.abrupt("return",t);case 10:throw e.prev=10,e.t0=e.catch(2),new Error("Unable to get the token");case 13:case"end":return e.stop()}}),e,this,[[2,10]])})))},this.invoke=function(e){return(0,s.__awaiter)(a,void 0,void 0,(0,n.Z)().mark((function t(){var r,a,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getInvokeRequestUrl(),t.next=3,this.getInvokeRequestHeaders();case 3:return a=t.sent,t.next=6,(0,K.q)(r,{method:"POST",headers:a,body:JSON.stringify(e)},6e4,{maxRetries:3,filter:(0,X.m)({min:500,max:599}),backOffFn:(0,$.Tv)(500)});case 6:if((i=t.sent).result.ok&&i.result.status===ee.W.Ok){t.next=9;break}throw i;case 9:return t.next=11,i.result.json();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t,this)})))}})),ne=(0,o.Z)((function e(t){var r=this;(0,i.Z)(this,e),this.tokenProvider=t,this.getRequestUrl=function(){return"https://substrate.office.com/search/api/v1/verifyCards"},this.getRequestHeaders=function(){return(0,s.__awaiter)(r,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new Headers).set("Content-Type","application/json"),e.prev=2,e.next=5,this.tokenProvider.getToken([te]);case 5:return(r=e.sent)&&t.set("Authorization","Bearer ".concat(r.token)),e.abrupt("return",t);case 10:throw e.prev=10,e.t0=e.catch(2),new Error("Unable to get the token");case 13:case"end":return e.stop()}}),e,this,[[2,10]])})))},this.invoke=function(e){return(0,s.__awaiter)(r,void 0,void 0,(0,n.Z)().mark((function t(){var r,a,i,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getRequestUrl(),t.next=3,this.getRequestHeaders();case 3:return a=t.sent,t.next=6,(0,K.q)(r,{method:"POST",headers:a,body:JSON.stringify(e)},6e4,{maxRetries:3,filter:(0,X.m)({min:500,max:599}),backOffFn:(0,$.Tv)(500)});case 6:if((i=t.sent).result.ok&&i.result.status===ee.W.Ok){t.next=9;break}throw i;case 9:return t.next=11,i.result.json();case 11:if(0!==(o=t.sent).cards.length){t.next=14;break}throw o;case 14:return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,this)})))}})),ae="SignInCard";function ie(e){var t,r,n,a;try{var i=e.response.composeExtension.type;switch(i){case"result":var o=e.response.composeExtension.attachments;if(!o)throw new Error("Attachments not defined for successful unfurl");return{cardType:null!==(t=o[0].contentType)&&void 0!==t?t:void 0,payload:null!==(r=o[0].content)&&void 0!==r?r:void 0,signature:null!==(n=o[0].signature)&&void 0!==n?n:void 0,fallbackHtml:null!==(a=o[0].fallbackHtml)&&void 0!==a?a:void 0};case"silentAuth":return{cardType:ae,payload:{type:"silentAuth",requiresUserConsent:!1}};case"auth":var s=e.response.composeExtension.suggestedActions,u=null===s||void 0===s?void 0:s.actions[0].value;if(!u)throw new Error("Url not present for Nominal auth response");return{cardType:ae,payload:{type:"auth",authUrl:new URL(u)}};default:throw new Error("Unknown response type: ".concat(i))}}catch(d){throw new Error("Error while parsing the Unfurl response")}}function oe(e){var t,r=e.response;return{statusCode:"".concat(r.statusCode),contentType:r.type,content:r.value,signature:null!==(t=r.signature)&&void 0!==t?t:void 0}}var se,ue,de,ce=(0,o.Z)((function e(t,r,a,o,d,c){var l=this;(0,i.Z)(this,e),this.appId=t,this.botId=r,this.isEmbeddedCard=a,this.metaOSProvider=o,this.loopContext=d,this.cardData=c,this.getQueryLinkRequestPayload=function(e,t,r){var n={url:e.href};if(r&&t)"silentAuth"===r?n.authentication={token:t}:"auth"===r&&(n.state=t);else if(r||t)throw new Error("Trying to Unfurl without AuthType or AuthCode when re-unfurling for AuthResponse");return l.getInvokeRequestPayload("composeExtension/queryLink",n)},this.getAdaptiveActionRequestPayload=function(e,t,r,n){var a,i={action:e,trigger:t};r&&(i.state=r),n&&(i.authentication={token:n});var o={};return l.isEmbeddedCard&&"automatic"===t&&"Unknown"===(null===(a=l.cardData)||void 0===a?void 0:a.verificationStatus)&&(o.verifyCardSignature={card:JSON.stringify(l.cardData.payload),signature:l.cardData.signature},l.cardData.updateExtension&&(o[l.cardData.updateExtension.type]=l.cardData.updateExtension.data)),l.getInvokeRequestPayload("adaptiveCard/action",i,o)},this.getInvokeRequestPayload=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,s.__awaiter)(l,void 0,void 0,(0,n.Z)().mark((function a(){var i,o,s;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.botId){n.next=5;break}return n.next=3,this.metaOSProvider.getAppDefinition(this.appId);case 3:o=n.sent,this.botId=B(o);case 5:if(this.botId){n.next=7;break}return n.abrupt("return",Promise.reject("No bot found"));case 7:return s={request:{metaOsAppId:this.appId,msaAppId:this.botId,name:e,value:t,extension:Object.assign({generateCardSignature:!0},r)},logicalId:(0,u.pW)(),scenario:{name:"genericloader"}},(null===(i=this.loopContext)||void 0===i?void 0:i.displayName)&&(s.imDisplayName=this.loopContext.displayName),n.abrupt("return",s);case 10:case"end":return n.stop()}}),a,this)})))},this.getBotInvokeRequest=function(e){return(0,s.__awaiter)(l,void 0,void 0,(0,n.Z)().mark((function t(){var r,a,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.requestBody.name,a={},t.t0=r,t.next="adaptiveCard/action"===t.t0?5:8;break;case 5:return i=e.requestBody,a.verifyCardSignature={card:i.serializedContent,signature:i.signature},t.abrupt("break",8);case 8:return t.next=10,this.getInvokeRequestPayload(r,e.requestBody.value,a);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})))}})),le=r(4942),ve=(0,o.Z)((function e(t){var r=this;(0,i.Z)(this,e),this.cardData=t,this.getRequestPayload=function(){if(!r.cardData.cardId||!r.cardData.signature||!r.cardData.payload)throw new Error("Unable to create request payload for VerifyCard");var e={request:[{cardId:r.cardData.cardId,signature:r.cardData.signature,content:JSON.stringify(r.cardData.payload)}],logicalId:(0,u.pW)(),cvid:(0,u.pW)(),scenario:{name:"genericloader"}};return r.cardData.updateExtension&&(e.request[0].extension=(0,le.Z)({},r.cardData.updateExtension.type,r.cardData.updateExtension.data)),e}})),pe=function(){function e(t,r,a,o,u,d,c){var l=this;(0,i.Z)(this,e),this.executeAdaptiveCardAction=function(e){return(0,s.__awaiter)(l,void 0,void 0,(0,n.Z)().mark((function t(){var r,a,i,o,s;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.actionProps,a=e.trigger,i=Object.assign({type:"Action.Execute"},r),t.next=5,this.botInvokeRequestBuilder.getAdaptiveActionRequestPayload(i,a,e.authCode,e.authToken);case 5:return o=t.sent,t.next=8,this.botService.invoke(o);case 8:return s=t.sent,t.abrupt("return",oe(s));case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",Promise.reject(new Error("Unable to execute the action")));case 15:case"end":return t.stop()}}),t,this,[[0,12]])})))},this.verifyCard=function(e){return(0,s.__awaiter)(l,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.verifyCardRequestBuilder&&this.verifyCardService){e.next=3;break}throw new Error("Unable to verify the card, VerifyCardService is empty");case 3:return t=this.verifyCardRequestBuilder.getRequestPayload(),e.next=6,this.verifyCardService.invoke(t);case 6:return r=e.sent,e.abrupt("return",r.cards[0].verificationStatus);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0 instanceof Error?e.t0:new Error("Unable to verify the card")));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})))},this.botInvokeRequestBuilder=new ce(t,r,a,u,d,c),this.botService=new re(o,d),a&&c&&(this.verifyCardRequestBuilder=new ve(c),this.verifyCardService=new ne(o))}return(0,o.Z)(e,[{key:"CardChannelProvider",get:function(){return this}},{key:"unfurl",value:function(e,t,r,a){var i;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var o,s,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.botInvokeRequestBuilder.getQueryLinkRequestPayload(e,r,a);case 3:return o=t.sent,t.next=6,this.botService.invoke(o);case 6:return s=t.sent,t.abrupt("return",ie(s));case 10:return t.prev=10,t.t0=t.catch(0),u="",t.t0 instanceof Error&&(u=null!==(i=t.t0.message)&&void 0!==i?i:t.t0.name),t.abrupt("return",Promise.reject(new Error("Unable to Unfurl the URL : ".concat(u))));case 15:case"end":return t.stop()}}),t,this,[[0,10]])})))}},{key:"botInvoke",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.botInvokeRequestBuilder.getBotInvokeRequest(e);case 3:return r=t.sent,t.abrupt("return",this.botService.invoke(r));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",Promise.reject(new Error("Unable to make botInvoke Request")));case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}}]),e}();function he(e,t,r,n,a,i){var o=n.CardChannelProvider,s=n.TokenProvider,u=n.MetaOSProvider;if(o)return a.logEvent("info","CardChannelSourceInfo",se.Host),o;if(s&&u){var d=new pe(e,t,r,s,u,a.loopContext,i);return a.logEvent("info","CardChannelSourceInfo",se.Default),d}a.logEvent("info","CardChannelSourceInfo",void 0)}!function(e){e.Host="Host",e.Default="Default"}(se||(se={}));try{ue=localStorage}catch(gt){}ue||(ue=void 0);try{de=sessionStorage}catch(mt){}de||(de=void 0);var fe=new URLSearchParams("undefined"!==typeof location?location.search:""),ge=new Map;function me(e,t){var r=function(e,t){var r,n,a,i=ge.get(e);if(void 0!==i)return i;a=void 0!==(r=function(e){var t=fe.get(e);return ye(t)}(e))?r:void 0!==(n=function(e){var t,r=null===(t=ue)||void 0===t?void 0:t.getItem(e);return ye(r)}(e))?n:t;return ge.set(e,a),a}(e,t);return r}function ye(e){if(null!==e&&void 0!==e){var t;try{t=JSON.parse(e)}catch(n){}var r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}var Ce;!function(e){e.UseM365CardRenderer="cardLoop.useM365CardRenderer"}(Ce||(Ce={}));var xe=function(e){var t=function(e,t,r){return r?r.getSetting(e,t,"FluidExperiences"):me(e,t)}(Ce.UseM365CardRenderer,!1,e);return t},be=function(){function e(t,r,n,a,o){(0,i.Z)(this,e),this.hostContext=t,this.settingsProvider=r,this.userContext=n,this.telemetryConfig=a,this.internationalizationContext=o}return(0,o.Z)(e,[{key:"user",get:function(){var e,t,r,n,a,i;if(null===(e=this.userContext)||void 0===e?void 0:e.user)return this.userContext.user;var o=null===(r=null===(t=this.hostContext)||void 0===t?void 0:t.userContext)||void 0===r?void 0:r.user;return o?{id:null!==(a=null!==(n=o.id)&&void 0!==n?n:o.oid)&&void 0!==a?a:"NotAvailable",tenantId:o.tenantId,userIdSpace:null!==(i=o.userIdSpace)&&void 0!==i?i:"OrgIdPuid"}:void 0}},{key:"displayName",get:function(){var e,t,r,n;return null!==(t=null===(e=this.userContext)||void 0===e?void 0:e.displayName)&&void 0!==t?t:null===(n=null===(r=this.hostContext)||void 0===r?void 0:r.userContext)||void 0===n?void 0:n.displayName}},{key:"hostCorrelationId",get:function(){var e,t,r;return null!==(t=null===(e=this.telemetryConfig)||void 0===e?void 0:e.hostCorrelationId)&&void 0!==t?t:null===(r=this.hostContext)||void 0===r?void 0:r.hostCorrelationId}},{key:"hostSessionId",get:function(){var e,t,r;return null!==(t=null===(e=this.telemetryConfig)||void 0===e?void 0:e.hostSessionId)&&void 0!==t?t:null===(r=this.hostContext)||void 0===r?void 0:r.hostSessionId}},{key:"uiLocale",get:function(){var e,t,r,n,a;return null!==(a=null!==(t=null===(e=this.internationalizationContext)||void 0===e?void 0:e.uiLocale)&&void 0!==t?t:null===(n=null===(r=this.hostContext)||void 0===r?void 0:r.hostLocaleContext)||void 0===n?void 0:n.uiLanguage)&&void 0!==a?a:Q}},{key:"defaultContentDirection",get:function(){var e,t,r,n,a;return null!==(a=null!==(t=null===(e=this.internationalizationContext)||void 0===e?void 0:e.defaultContentDirection)&&void 0!==t?t:null===(n=null===(r=this.hostContext)||void 0===r?void 0:r.hostLocaleContext)||void 0===n?void 0:n.defaultContentDirection)&&void 0!==a?a:"ltr"}},{key:"audience",get:function(){var e,t,r,n,a;return null!==(a=null!==(t=null===(e=this.settingsProvider)||void 0===e?void 0:e.audience)&&void 0!==t?t:null===(n=null===(r=this.hostContext)||void 0===r?void 0:r.environment)||void 0===n?void 0:n.audience)&&void 0!==a?a:"Automation"}},{key:"hostName",get:function(){var e;return null===(e=this.hostContext)||void 0===e?void 0:e.hostName}},{key:"hostAppName",get:function(){var e;return null===(e=this.hostContext)||void 0===e?void 0:e.hostAppName}},{key:"hostAppPlatform",get:function(){var e;return null===(e=this.hostContext)||void 0===e?void 0:e.hostAppPlatform}},{key:"hostAppVersion",get:function(){var e;return null===(e=this.hostContext)||void 0===e?void 0:e.hostAppVersion}}]),e}();function ke(e,t,r,n,a){return new be(e,t,a,n,r)}var we="application/vnd.microsoft.card.adaptive",Pe="application/vnd.microsoft.card.hero",Se="application/vnd.microsoft.card.thumbnail",Ee="application/vnd.microsoft.teams.card.o365connector",Ae="SignInCard";function Ie(e){return[we,Ee,Pe,Se,Ae].includes(e)}function De(e,t){var r,n;return{cardType:"JITInstallCard",payload:{},appId:null!==(r=t.appId)&&void 0!==r?r:"Unknown",cardId:e,webUrl:null===(n=t.urlData)||void 0===n?void 0:n.url,verificationStatus:"Success",registrationId:F}}function Ze(e,t,r,a,i,o,u){var d;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function s(){var c,l,v,p,h;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.cardType!==G){n.next=19;break}if("silentAuth"!==(c=a.payload).type||c.requiresUserConsent||!t.appId){n.next=19;break}return n.next=5,null===(d=o.openAuth)||void 0===d?void 0:d.call(o,t.appId,c,e);case 5:if((v=n.sent)&&v.status&&v.message){n.next=11;break}u.logEvent("info","RetrySSOWithConsent"),l=Object.assign(Object.assign({},a),{payload:{type:"silentAuth",requiresUserConsent:!0}}),n.next=18;break;case 11:return u.logEvent("info","RetryUnfurlSSO"),p=u.startPerfEvent("RetryUnfurl"),n.next=15,i.unfurl(e,r,v.message,c.type);case 15:h=n.sent,p.end(),l=Object.assign(Object.assign({},a),h);case 18:return n.abrupt("return",l);case 19:return n.abrupt("return",a);case 20:case"end":return n.stop()}}),s)})))}function Te(e,t,r,a,i,o){var u,d,c;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function l(){var v,p,h,f,g,m,y;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v=null===(u=e.urlData)||void 0===u?void 0:u.url){n.next=4;break}return o.logEvent("error","NoUrlFound"),n.abrupt("return",Promise.reject(new Error("Unable to retrieve URL")));case 4:if("undefined"!==typeof a){n.next=7;break}return o.logEvent("error","NoAppFound"),n.abrupt("return",Promise.reject(new Error("No suitable app found.")));case 7:if("NotInstalled"!==i){n.next=12;break}return o.logEvent("info","JITCardAdded"),n.abrupt("return",De(o.correlationId,e));case 12:if("Installed"===i){n.next=15;break}return o.logEvent("error","AppNotInstallable"),n.abrupt("return",Promise.reject("App not installable"));case 15:return n.prev=15,n.next=18,r.unfurl(v,a,void 0,void 0);case 18:if(p=n.sent,h=p.cardType,f=p.payload,g=(0,s.__rest)(p,["cardType","payload"]),h&&Ie(h)){n.next=22;break}throw new Error("Unsupported CardType: ".concat(h));case 22:if(f){n.next=24;break}throw new Error("Empty card payload.");case 24:return m=Object.assign(Object.assign({},g),{cardType:h,payload:f,cardId:o.correlationId,appId:null!==(d=e.appId)&&void 0!==d?d:"Unknown",botId:e.botId,appName:e.appName,webUrl:v,urlTitle:null===(c=e.urlData)||void 0===c?void 0:c.title,registrationId:F,verificationStatus:"Success"}),n.next=27,Ze(v,e,a,m,r,t,o);case 27:return y=n.sent,n.abrupt("return",Promise.resolve(y));case 31:return n.prev=31,n.t0=n.catch(15),o.logEvent("error","ErrorWhileUnfurl",n.t0 instanceof Error?n.t0.message||n.t0.name:void 0),n.abrupt("return",Promise.reject(n.t0));case 35:case"end":return n.stop()}}),l,null,[[15,31]])})))}function Me(e,t){var r,n,a=e.updateExtension;"updateExtendedProps"===(null===a||void 0===a?void 0:a.type)&&(e.updateExtension={type:"updateExtendedProps",data:Object.assign(Object.assign({},a.data),{appIcon:null!==(r=null===t||void 0===t?void 0:t.icon)&&void 0!==r?r:a.data.appIcon,appName:null!==(n=null===t||void 0===t?void 0:t.displayName)&&void 0!==n?n:a.data.appName})})}var _e=r(77433),Ue=r(72791),Oe=r(54164);function Re(e){e.addEventListener("keydown",(function(e){e.stopPropagation()}))}var Le,Ne=r(94577),Be=(0,Ue.createContext)({messageData:{message:null,messageType:"info",dismissType:"auto"}}),He=Be.Provider,Fe=r(84398),qe=r(72341),Ve=r(80111),We=r(20112),je=r(37837),Ge=r(10759),ze=r(3717),Je=r(42110),Ye=(0,ze.NF)((function(){return(0,Je.ZC)({cardContainer:{maxWidth:"640px",position:"relative"}})})),Qe=r(86359);!function(e){e.themePropertiesChanged="themePropertiesChanged",e.textStylesChanged="textStylesChanged"}(Le||(Le={}));var Ke=Ue.lazy((function(){return Promise.all([r.e(5747),r.e(8162),r.e(5729)]).then(r.bind(r,50299))})),Xe=Ue.lazy((function(){return Promise.all([r.e(5747),r.e(7868)]).then(r.bind(r,14540))})),$e=Ue.lazy((function(){return Promise.all([r.e(4927),r.e(4190),r.e(6682)]).then(r.bind(r,35805))})),et=Ue.lazy((function(){return Promise.all([r.e(4927),r.e(4190),r.e(4399)]).then(r.bind(r,51358))})),tt=Ue.lazy((function(){return Promise.all([r.e(4927),r.e(6558)]).then(r.bind(r,7063))})),rt=r(62827),nt=Ue.lazy((function(){return Promise.all([r.e(4927),r.e(4190),r.e(7057)]).then(r.bind(r,15045))})),at=Ue.lazy((function(){return Promise.all([r.e(4927),r.e(4190),r.e(8814)]).then(r.bind(r,24686))})),it=function(){var e=(0,Ne.R)(),t=e.cardData,r=e.cardDataHandler,n=(0,qe.v)(),a=n.renderPerfMarker,i=n.logger,o=(0,Fe.o)().settingsProvider,s=t.cardType;if(Ue.useEffect((function(){a.end()}),[a]),Ue.useEffect((function(){i.logEvent("info","ViewRenderSuccess")}),[i]),Ue.useEffect((function(){switch(t.cardType){case q:case W:case V:case j:null===r||void 0===r||r.resolver(t);break;case G:case z:break;default:null===r||void 0===r||r.rejector()}}),[t,t.cardType,r]),xe(o))return Ue.createElement(Ke,{key:"CardLoopM365CardRenderer"});switch(s){case q:return Ue.createElement(Xe,{key:"AdaptiveCard"});case j:return Ue.createElement($e,{key:"ConnectorsCard"});case V:return Ue.createElement(et,{key:"HeroCard"});case W:return Ue.createElement(at,{key:"ThumbnailCard"});case G:return Ue.createElement(nt,{key:"SignInCard"});case z:return Ue.createElement(tt,{key:"JITInCompose"});default:return Ue.createElement(rt.F,{message:"Unsupported card type"})}},ot=r(50199),st=r(77291),ut=r(64317),dt=function(){var e=(0,Ue.useContext)(Be).messageData,t=(0,We.R)().setMessageData,r=Ue.useCallback((function(){t&&t({message:null,messageType:"info",dismissType:"auto"})}),[t]);return Ue.useEffect((function(){if("auto"===e.dismissType){var t=setTimeout((function(){r()}),5e3);return function(){return clearTimeout(t)}}}),[e.dismissType,r]),Ue.createElement(ot.c,{messageBarType:ct(e.messageType),onDismiss:r,isMultiline:!1,actions:lt(e.actionProps)},e.message)},ct=function(e){switch(e){case"error":return st.f.error;case"success":return st.f.success;default:return st.f.info}},lt=function(e){if("undefined"!==typeof e)return Ue.createElement(ut.f,{onClick:e.onClick},e.message)},vt=function(e){var t=e.initialCardData,r=e.metaOSProvider,n=e.logger,i=e.appStatus,o=e.stylingProvider,s=e.cardChannelProvider,u=e.cardDataHandler,d=e.updateVerificationStatus,c=e.urlData,l=e.urlHandlerProvider,v=e.isVerificationRequired,p=e.baseCardPerfMarker,h=e.renderPerfMarker,f=e.settingsProvider,g=e.tokenProvider,m=function(e,t){var r=Ue.useState({name:Z(null===e||void 0===e?void 0:e.themeProperties),theme:(0,Qe.X)(null===e||void 0===e?void 0:e.themeProperties)}),n=(0,a.Z)(r,2),i=n[0],o=n[1];return Ue.useEffect((function(){var r=function(r){var n=null===e||void 0===e?void 0:e.themeProperties,a=(null===r||void 0===r?void 0:r.get(D))!==(null===n||void 0===n?void 0:n.get(D));o({name:Z(n),theme:(0,Qe.X)(n)}),t.logEvent("info",a?"ThemeModeChanged":"ThemeChanged")};return null===e||void 0===e||e.addListener(Le.themePropertiesChanged,r),function(){null===e||void 0===e||e.removeListener(Le.themePropertiesChanged,r)}}),[]),i}(o,n),y=Ue.useState(i),C=(0,a.Z)(y,2),x=C[0],b=C[1],k=Ue.useState(t),w=(0,a.Z)(k,2),P=w[0],S=w[1],E=Ue.useCallback((function(e,t,r){S(r||function(e){return Object.assign(Object.assign({},e),{botId:t.botId,appName:t.displayName})}),b(e),U({message:null,messageType:"info",dismissType:"auto"})}),[]),A=Ue.useCallback((function(e){"Installed"===e?H.getAppRegistryData(t.appId,r,n).then((function(a){a&&("JITInstallCard"===P.cardType?Te({cardData:P,urlData:c,shouldVerifyCard:v,initialSource:"URL"},r,s,t.appId,e,n).then((function(t){E(e,a,t)})).catch((function(){E(e,a)})):E(e,a))})).catch((function(){n.logEvent("error","AppDataFetchError")})):b(e)}),[E,s,P,t.appId,v,n,r,c]),I=Ue.useCallback((function(e){P.verificationStatus=e,d(e)}),[P,d]),T=Ue.useState((function(){var e;return"Installed"===i||"JITInstallCard"===P.cardType?{message:null,messageType:"info",dismissType:"auto"}:null!==(e=(0,je.S)(i,"Success",(0,Ge.u)(t.appId,i,r,A)))&&void 0!==e?e:{message:null,messageType:"info",dismissType:"auto"}})),M=(0,a.Z)(T,2),_=M[0],U=M[1],O=Ue.useMemo((function(){return{urlData:c,cardData:P,cardDataHandler:u,isVerificationRequired:v,appStatus:x}}),[c,P,u,v,x]),R=Ue.useMemo((function(){return{setAppStatus:A,setCardData:S,setMessageData:U,setVerificationStatus:I}}),[A,I]),L=m,N=Ue.useMemo((function(){return{messageData:_}}),[_]),B=Ue.useMemo((function(){return{cardChannelProvider:s,metaOSProvider:r,stylingProvider:o,urlHandlerProvider:l,settingsProvider:f,tokenProvider:g}}),[s,r,o,l,f,g]),F=Ue.useMemo((function(){return{logger:n,baseCardPerfMarker:p,renderPerfMarker:h}}),[p,n,h]);return Ue.createElement(Ne.U,{value:O},Ue.createElement(He,{value:N},Ue.createElement(Fe.u,{value:B},Ue.createElement(qe.n,{value:F},Ue.createElement(Ve.z,{value:L},Ue.createElement(We.C,{value:R},Ue.createElement("div",{key:"cardContainer",className:Ye().cardContainer},Ue.createElement(Ue.Suspense,{fallback:Ue.createElement(_e.u3,null)},Ue.createElement(it,{key:"cardContent"}),!!_.message&&Ue.createElement(dt,null)))))))))},pt=function(){function e(t,r,n,a,o,s,u){(0,i.Z)(this,e),this.bootDataPromise=t,this.cardDataHandler=r,this.isVerificationRequired=n,this.updateVerificationStatus=a,this.parentDivUtils=o,this.baseCardPerfMarker=s,this.logger=u}return(0,o.Z)(e,[{key:"HTMLView",get:function(){return this}},{key:"Focusable",get:function(){return this}},{key:"dispose",value:function(){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.parentDivUtils.parentDiv)&&Oe.unmountComponentAtNode(t);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"render",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var r=this;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.parentDivUtils.parentDiv=e,Oe.render(Ue.createElement(_e.u3,null),e),Re(e),t.abrupt("return",new Promise((function(t,n){r.bootDataPromise.then((function(n){if(!n||!n.cardData)throw new Error("No Card data found");var a=r.logger.startPerfEvent("ViewRenderer");Oe.render(Ue.createElement(vt,{urlData:n.urlData,initialCardData:n.cardData,appStatus:n.appStatus,cardDataHandler:r.cardDataHandler,isVerificationRequired:r.isVerificationRequired,updateVerificationStatus:r.updateVerificationStatus,cardChannelProvider:n.providers.CardChannelProvider,metaOSProvider:n.providers.MetaOSProvider,stylingProvider:n.providers.StylingProvider,urlHandlerProvider:n.providers.UrlHandlerProvider,baseCardPerfMarker:r.baseCardPerfMarker,renderPerfMarker:a,logger:r.logger,settingsProvider:n.providers.SettingsProvider,tokenProvider:n.providers.TokenProvider}),e,t)})).catch((function(e){var t;null===(t=r.cardDataHandler)||void 0===t||t.rejector(),n(e)}))})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"giveFocus",value:function(){return this.parentDivUtils.setFocus(!0),!0}},{key:"isFocused",value:function(){return this.parentDivUtils.isInFocus}},{key:"setHostFocusCallback",value:function(e){this.parentDivUtils.moveFocusToHostCallback=e}}]),e}(),ht=function(){function e(t,r){var o,u=this;(0,i.Z)(this,e),this.providers=r,this.parentDivUtils=new M,this.loadProviders=function(){return(0,s.__awaiter)(u,void 0,void 0,(0,n.Z)().mark((function e(){var t,r,i,o,s,u,d,c,l,v,p,h,f,g,m,y,C,x,b,k,w,P,S;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=this.logger.startPerfEvent("ProvidersFetch"),e.next=3,Promise.all([null===(t=this.providers)||void 0===t?void 0:t.CardChannelProvider,null===(r=this.providers)||void 0===r?void 0:r.HostContext,null===(i=this.providers)||void 0===i?void 0:i.MetaOSProvider,null===(o=this.providers)||void 0===o?void 0:o.SettingsProvider,null===(s=this.providers)||void 0===s?void 0:s.StylingProvider,null===(u=this.providers)||void 0===u?void 0:u.TokenProvider,null===(d=this.providers)||void 0===d?void 0:d.UrlHandlerProvider,null===(c=this.providers)||void 0===c?void 0:c.InternationalizationContext,null===(l=this.providers)||void 0===l?void 0:l.TelemetryConfig,null===(v=this.providers)||void 0===v?void 0:v.UserContext]);case 3:return h=e.sent,f=(0,a.Z)(h,10),g=f[0],m=f[1],y=f[2],C=f[3],x=f[4],b=f[5],k=f[6],w=f[7],P=f[8],S=f[9],p.end(),e.abrupt("return",{CardChannelProvider:g,HostContext:m,MetaOSProvider:y,SettingsProvider:C,StylingProvider:x,TokenProvider:b,UrlHandlerProvider:k,InternationalizationContext:w,TelemetryConfig:P,UserContext:S});case 17:case"end":return e.stop()}}),e,this)})))},this.updateVerificationStatus=function(e){u.data.cardData&&(u.data.cardData.verificationStatus=e)};var d=t.creationData.dataType,c=function(e){if("Card"===e.dataType)return e.data.cardId}(t.creationData);this.logger=new E(d,null===r||void 0===r?void 0:r.LoopTelemetrySink,c);var l=this.logger.startPerfEvent("CtorInit");this.data=J(t.creationData,this.logger),this.loggerInitPromise=function(e,t){return(0,s.__awaiter)(void 0,void 0,void 0,(0,n.Z)().mark((function r(){var i,o,s,u,d,c,l;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Promise.all([null===t||void 0===t?void 0:t.HostContext,null===t||void 0===t?void 0:t.SettingsProvider,null===t||void 0===t?void 0:t.InternationalizationContext,null===t||void 0===t?void 0:t.TelemetryConfig,null===t||void 0===t?void 0:t.UserContext]);case 2:i=r.sent,o=(0,a.Z)(i,5),s=o[0],u=o[1],d=o[2],c=o[3],l=o[4],e.LoopContext=ke(s,u,d,c,l),e.IsM365CardRendererEnabled=xe(u);case 11:case"end":return r.stop()}}),r)})))}(this.logger,this.providers),this.initialCardDataPromise=new Promise((function(e,t){u.initialCardDataHandler={resolver:e,rejector:t}})),this.appRegistryDataPromise=H.getAppRegistryDataWithProviderPromise(this.data.appId,null===(o=this.providers)||void 0===o?void 0:o.MetaOSProvider,this.logger),this.bootDataPromise=this.populateBootData(),l.end()}return(0,o.Z)(e,[{key:"HTMLViewable",get:function(){return this}},{key:"ContentURL",get:function(){return this}},{key:"ComponentProperties",get:function(){return this}},{key:"ComponentInitializer",get:function(){return this}},{key:"ComponentMetadata",get:function(){return this}},{key:"LoopState",get:function(){return this}},{key:"ComponentFocusable",get:function(){return this}},{key:"EmbedCardData",get:function(){return this}},{key:"initialize",value:function(){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getName();case 2:return this.name=e.sent,e.next=5,this.getIconUrl();case 5:this.iconUrl=e.sent;case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getTitle",value:function(){return Promise.resolve(void 0)}},{key:"getName",value:function(){var e,t;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function r(){var a,i,o;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loggerInitPromise;case 2:return a=this.logger.startPerfEvent("GetTitle"),r.next=5,this.appRegistryDataPromise;case 5:return i=r.sent,o=null!==(t=null!==(e=null===i||void 0===i?void 0:i.displayName)&&void 0!==e?e:this.data.appName)&&void 0!==t?t:"Unknown",a.end(),r.abrupt("return",Promise.resolve(o));case 9:case"end":return r.stop()}}),r,this)})))}},{key:"getIconUrl",value:function(){var e;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function t(){var r,a,i,o,s;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loggerInitPromise;case 2:return r=this.logger.startPerfEvent("GetIcon"),t.next=5,this.appRegistryDataPromise;case 5:if(!(null===(a=t.sent)||void 0===a?void 0:a.icon)){t.next=9;break}return r.end(),t.abrupt("return",Promise.resolve(a.icon));case 9:return t.next=11,null===(e=this.providers)||void 0===e?void 0:e.StylingProvider;case 11:return i=t.sent,o=Z(null===i||void 0===i?void 0:i.themeProperties),s="Dark"===o?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFcSURBVHgB7Za/SsRAEIdng21C+jSmUjsFLz6GF3sVayPomwjG+vDszdmrYHmJoJ3a2aQPyQOs81uIaAR3OS/LFfdBGLKw+bI7+2cEMasMh5EQYpOjT3NGSjnhcPbBCMhY9NyHqEPF4i2HZecWZMBn10iEYSjJHpVDdvFtC2kp/JM4HtJTkdN4fEWu6xr10QqT5Jje315/PGiD7CRJaHcYU5EXdG0o1W4LCLYHETVNo949z2PBlMqypP2DQxUB5FE0UG3/GiFoZaCuaxWnef4lAzdZxsJI+62Zc7jDH8fUgiAI1JSm6aW23wrNCKYOEsggz7IJXaSptp+REHns8nB/p+JeHKsoyeyENBKurW/8+oHvbe1CMpnSuWz8diGZsJgnjW5Dm54yQJtD5AXHV5fuQjLJH7B9AS+vp36EFVkEwheyx63DxekR2RklCuFTB+U3KmLYqR8wmEc44PoE8amRnyPm1jIAAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFpSURBVHgB7Za/S8NAHMVfqsXgYGoRrSixIG6Wuik4ODoVR1FEXesguIijODi4CA7qqgjiKAX/A0HctEtBxBgQO5kEpcYfMd4dmCXfgxYSpNDPkuPd5fvu8i65KNbb5zKUxC4UpBAtRpuCTcWqeQ+An0Uc+LCZwbePGEkgZmI3aJd1mPZXSNNTyaCvcGSKdmlJD/S6DVbOn3H5WAvpuT4V29O9ovjGVA9GMx2ifTI7iBxrU5AhZ3fuYKyPhAZ3b1Wga0lRfG5ME1q56mLh7ElqQmagqfJoihPpoLhYVUZlxQdQODbJ8Q2HbLteSCtXP6STkoYs46LyKq78MXEOrl5weG2htKhHY8B3zd8OYm8qTm8dUVy2k8iQRZjEDXx7UvrkUCf2Z/pBQa6AF7lZHQZlTOn5vXvIaP5Pxf8YOO4PGsF596R9ZMjz+S4RKAWlF8fTkNE6cOowYAcz4sPgBmssCgNRwyfOflt+ARFbdVnDYpyEAAAAAElFTkSuQmCC",r.end(),t.abrupt("return",Promise.resolve(s));case 16:case"end":return t.stop()}}),t,this)})))}},{key:"identityName",get:function(){return Promise.resolve(F)}},{key:"isLoop",value:function(){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loggerInitPromise;case 2:return t=this.logger.startPerfEvent("GetIsLoop"),e.prev=3,e.next=6,this.initialCardDataPromise;case 6:if(r=e.sent,!T(r,this.logger)){e.next=10;break}return t.end(),e.abrupt("return",Promise.resolve(!0));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),this.logger.logEvent("error","IsLoopError");case 15:return e.abrupt("return",Promise.resolve(!1));case 16:case"end":return e.stop()}}),e,this,[[3,12]])})))}},{key:"getContentURL",value:function(){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data.urlData){e.next=5;break}return e.next=3,this.loggerInitPromise;case 3:throw this.logger.logEvent("error","NoUrlFound"),Error("Unable to retrieve URL");case 5:return e.abrupt("return",this.data.urlData.url);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getView",value:function(){return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loggerInitPromise;case 2:return t=this.logger.startPerfEvent("LoopGetView"),r=this.getCardView(),t.end(),e.abrupt("return",Promise.resolve(r));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"giveFocus",value:function(e){return this.parentDivUtils.setFocus(!0,e),!0}},{key:"isComponentFocused",value:function(){return this.parentDivUtils.isInFocus}},{key:"setHostComponentFocusable",value:function(e){this.parentDivUtils.hostComponent=e}},{key:"getData",value:function(){var e,t;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function r(){var a,i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loggerInitPromise;case 2:if(a=this.logger.startPerfEvent("GetCardData"),this.data.shouldEmbedData){r.next=5;break}return r.abrupt("return",Promise.reject());case 5:return r.prev=5,r.next=8,this.initialCardDataPromise;case 8:if(!(i=r.sent)){r.next=13;break}return(null===(e=this.data.urlData)||void 0===e?void 0:e.url)&&(i.webUrl=null===(t=this.data.urlData)||void 0===t?void 0:t.url),a.end(),r.abrupt("return",Promise.resolve(i));case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(5),this.logger.logEvent("error","GetDataError");case 18:return r.abrupt("return",Promise.reject());case 19:case"end":return r.stop()}}),r,this,[[5,15]])})))}},{key:"populateBootData",value:function(){var e,t,r;return(0,s.__awaiter)(this,void 0,void 0,(0,n.Z)().mark((function a(){var i,o,s,u,d;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.loggerInitPromise;case 2:return i=this.loadProviders(),n.next=5,this.appRegistryDataPromise;case 5:return o=n.sent,n.next=8,i;case 8:if((s=n.sent).MetaOSProvider){n.next=14;break}throw this.logger.logEvent("error","NoMetaOSProvider"),new Error("No MetaOSProvider available");case 14:s.MetaOSProvider=new A(s.MetaOSProvider,this.logger);case 15:if(o&&this.data.appId){n.next=18;break}throw this.logger.logEvent("error","AppDataFetchError"),new Error("Unable to retrieve app data");case 18:return o.botId&&(a=this.data,c=o.botId,a.botId=c),o.displayName&&Y(this.data,o.displayName),this.logger.logEvent("info","AppDataFetched"),n.next=23,null===(t=(e=s.MetaOSProvider).getAppStatus)||void 0===t?void 0:t.call(e,this.data.appId);case 23:if(n.t1=r=n.sent,n.t0=null!==n.t1,!n.t0){n.next=27;break}n.t0=void 0!==r;case 27:if(!n.t0){n.next=31;break}n.t2=r,n.next=32;break;case 31:n.t2="Unknown";case 32:if(u=n.t2,this.logger.logEvent("info","AppStatus",u),d=he(this.data.appId,this.data.botId,this.data.shouldVerifyCard,s,this.logger,this.data.cardData)){n.next=40;break}throw this.logger.logEvent("error","NoCardChannel"),new Error("No CardChannelProvider available");case 40:d=new I(d,this.logger);case 41:if(this.data.cardData){n.next=45;break}return n.next=44,Te(this.data,s.MetaOSProvider,d,this.data.appId,u,this.logger);case 44:this.data.cardData=n.sent;case 45:if(this.data.cardData){n.next=47;break}throw new Error("Unable to get the card data");case 47:return Me(this.data.cardData,o),n.abrupt("return",{urlData:this.data.urlData,cardData:this.data.cardData,appStatus:u,providers:{CardChannelProvider:d,MetaOSProvider:s.MetaOSProvider,SettingsProvider:s.SettingsProvider,StylingProvider:s.StylingProvider,UrlHandlerProvider:s.UrlHandlerProvider,TokenProvider:s.TokenProvider}});case 49:case"end":return n.stop()}var a,c}),a,this)})))}},{key:"getCardView",value:function(){var e=this.logger.startPerfEvent("E2ECardRender");!function(){var e=document.getElementById("fluidElement");e&&(e.style.maxWidth="640px",e.style.width="100%")}();var t=new pt(this.bootDataPromise,this.initialCardDataHandler,this.data.shouldVerifyCard,this.updateVerificationStatus,this.parentDivUtils,e,this.logger);return this.logger.logEvent("info","LoopGetViewSuccess"),Promise.resolve(t)}}]),e}(),ft=new N(ht,{TokenProvider:"TokenProvider",SettingsProvider:"SettingsProvider",NamespaceLogger:"NamespaceLogger",HostContext:"HostContext",StylingProvider:"StylingProvider",CardChannelProvider:"CardChannelProvider",MetaOSProvider:"MetaOSProvider",UrlHandlerProvider:"UrlHandlerProvider",LoopTelemetrySink:"LoopTelemetrySink",InternationalizationContext:"InternationalizationContext",TelemetryConfig:"TelemetryConfig",UserContext:"UserContext"});window[F]={loopExport:ft}},77433:function(e,t,r){r.d(t,{u3:function(){return i}});var n=r(86857),a=r(72791),i=a.memo((function(){var e="15px";return a.createElement("div",{style:{padding:"25px 20px 20px 20px"},"data-testid":"loadingPlaceholderTestId",className:"loadingPlaceHolderClass"},a.createElement(n.q,{height:e,width:"140px",style:{paddingBottom:"20px"}}),a.createElement(n.q,{height:e,width:"244px",style:{paddingBottom:"9px"}}),a.createElement(n.q,{height:e,width:"296px",style:{paddingBottom:"9px"}}),a.createElement(n.q,{height:e,width:"187px"}))}))},64317:function(e,t,r){r.d(t,{f:function(){return c}});var n=r(75971),a=r(72791),i=r(81318),o=r(5084),s=r(25199),u=r(42110),d=(0,r(3717).NF)((function(e,t){return(0,u.E$)({root:[(0,u.GL)(e,{inset:1,highContrastStyle:{outlineOffset:"-4px",outline:"1px solid Window"},borderColor:"transparent"}),{height:24}]},t)})),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return a.createElement(i.a,(0,n.__assign)({},this.props,{styles:d(r,t),onRenderDescription:o.S}))},t=(0,n.__decorate)([(0,s.a)("MessageBarButton",["theme","styles"],!0)],t)}(a.Component)},50199:function(e,t,r){r.d(t,{c:function(){return T}});var n,a=r(19482),i=r(75971),o=r(72791),s=r(41693),u=r(73341),d=r(62263),c=r(29577),l=r(29093),v=r(18511),p=r(77291),h=r(57717),f=r(5048),g=((n={})[p.f.info]="Info",n[p.f.warning]="Info",n[p.f.error]="ErrorBadge",n[p.f.blocked]="Blocked2",n[p.f.severeWarning]="Warning",n[p.f.success]="Completed",n),m=(0,s.y)(),y=function(e){switch(e){case p.f.blocked:case p.f.error:case p.f.severeWarning:return"assertive"}return"polite"},C=function(e){switch(e){case p.f.blocked:case p.f.error:case p.f.severeWarning:return"alert"}return"status"},x=o.forwardRef((function(e,t){var r=(0,h.k)(!1),n=r[0],a=r[1].toggle,s=(0,f.M)("MessageBar"),x=e.actions,b=e.className,k=e.children,w=e.overflowButtonAriaLabel,P=e.dismissIconProps,S=e.styles,E=e.theme,A=e.messageBarType,I=void 0===A?p.f.info:A,D=e.onDismiss,Z=void 0===D?void 0:D,T=e.isMultiline,M=void 0===T||T,_=e.truncated,U=e.dismissButtonAriaLabel,O=e.messageBarIconProps,R=e.role,L=e.delayedRender,N=void 0===L||L,B=e.expandButtonProps,H=(0,u.pq)(e,u.iY,["className","role"]),F=m(S,{theme:E,messageBarType:I||p.f.info,onDismiss:void 0!==Z,actions:void 0!==x,truncated:_,isMultiline:M,expandSingleLine:n,className:b}),q={iconName:n?"DoubleChevronUp":"DoubleChevronDown"},V=x||Z?{"aria-describedby":s,role:"region"}:{},W=x?o.createElement("div",{className:F.actions},x):null,j=Z?o.createElement(l.h,{disabled:!1,className:F.dismissal,onClick:Z,iconProps:P||{iconName:"Clear"},title:U,ariaLabel:U}):null;return o.createElement("div",(0,i.__assign)({ref:t,className:F.root},V),o.createElement("div",{className:F.content},o.createElement("div",{className:F.iconContainer,"aria-hidden":!0},O?o.createElement(v.J,(0,i.__assign)({},O,{className:(0,d.i)(F.icon,O.className)})):o.createElement(v.J,{iconName:g[I],className:F.icon})),o.createElement("div",{className:F.text,id:s,role:R||C(I),"aria-live":y(I)},o.createElement("span",(0,i.__assign)({className:F.innerText},H),N?o.createElement(c.U,null,o.createElement("span",null,k)):o.createElement("span",null,k))),!M&&!W&&_&&o.createElement("div",{className:F.expandSingleLine},o.createElement(l.h,(0,i.__assign)({disabled:!1,className:F.expand,onClick:a,iconProps:q,ariaLabel:w,"aria-expanded":n},B))),!M&&W,!M&&j&&o.createElement("div",{className:F.dismissSingleLine},j),M&&j),M&&W)}));x.displayName="MessageBar";var b,k,w,P,S=r(42110),E={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},A=((b={})[p.f.error]="errorBackground",b[p.f.blocked]="errorBackground",b[p.f.success]="successBackground",b[p.f.warning]="warningBackground",b[p.f.severeWarning]="severeWarningBackground",b[p.f.info]="infoBackground",b),I=((k={})[p.f.error]="errorIcon",k[p.f.blocked]="errorIcon",k[p.f.success]="successIcon",k[p.f.warning]="warningIcon",k[p.f.severeWarning]="severeWarningIcon",k[p.f.info]="infoIcon",k),D=((w={})[p.f.error]="#ff0000",w[p.f.blocked]="#ff0000",w[p.f.success]="#bad80a",w[p.f.warning]="#fff100",w[p.f.severeWarning]="#ff0000",w[p.f.info]="WindowText",w),Z=((P={})[p.f.error]="#e81123",P[p.f.blocked]="#e81123",P[p.f.success]="#107c10",P[p.f.warning]="#966400",P[p.f.severeWarning]="#d83b01",P[p.f.info]="WindowText",P),T=(0,a.z)(x,(function(e){var t,r,n,a,o,s,u,d,c,l,v,h=e.theme,f=e.className,g=e.onDismiss,m=e.truncated,y=e.isMultiline,C=e.expandSingleLine,x=e.messageBarType,b=void 0===x?p.f.info:x,k=h.semanticColors,w=h.fonts,P=(0,S.sK)(0,S.mV),T=(0,S.Cn)(E,h),M={fontSize:S.ld.xSmall,height:10,lineHeight:"10px",color:k.messageText,selectors:(t={},t[S.qJ]=(0,i.__assign)((0,i.__assign)({},(0,S.xM)()),{color:"WindowText"}),t)},_=[(0,S.GL)(h,{inset:1,highContrastStyle:{outlineOffset:"-6px",outline:"1px solid Highlight"},borderColor:"transparent"}),{flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":M,":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}}];return{root:[T.root,w.medium,b===p.f.error&&T.error,b===p.f.blocked&&T.blocked,b===p.f.severeWarning&&T.severeWarning,b===p.f.success&&T.success,b===p.f.warning&&T.warning,y?T.multiline:T.singleline,!y&&g&&T.dismissalSingleLine,!y&&m&&T.expandingSingleLine,{background:k[A[b]],boxSizing:"border-box",color:k.messageText,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(r={".ms-Link":{color:k.messageLink,selectors:{":hover":{color:k.messageLinkHovered}}}},r[S.qJ]=(0,i.__assign)((0,i.__assign)({},(0,S.xM)()),{background:"transparent",border:"1px solid ".concat(D[b]),color:"WindowText"}),r[S.bO]={border:"1px solid ".concat(Z[b])},r)},y&&{flexDirection:"column"},f],content:[T.content,(n={display:"flex",width:"100%",lineHeight:"normal"},n[P]={display:"grid",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto",gridTemplateAreas:'\n            "icon text close"\n            "action action action"\n          '},n)],iconContainer:[T.iconContainer,(a={fontSize:S.ld.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"},a[P]={gridArea:"icon"},a)],icon:{color:k[I[b]],selectors:(o={},o[S.qJ]=(0,i.__assign)((0,i.__assign)({},(0,S.xM)()),{color:"WindowText"}),o)},text:[T.text,(0,i.__assign)((0,i.__assign)({minWidth:0,display:"flex",flexGrow:1,margin:8},w.small),(s={},s[P]={gridArea:"text"},s.selectors=(u={},u[S.qJ]=(0,i.__assign)({},(0,S.xM)()),u),s)),!g&&{marginRight:12}],innerText:[T.innerText,{lineHeight:16,selectors:{"& span a:last-child":{paddingLeft:4}}},m&&{overflow:"visible",whiteSpace:"pre-wrap"},!y&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!y&&!m&&{selectors:(d={},d[P]={overflow:"visible",whiteSpace:"pre-wrap"},d)},C&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[T.dismissSingleLine,(c={},c[P]={gridArea:"close"},c)],expandSingleLine:T.expandSingleLine,dismissal:[T.dismissal,_],expand:[T.expand,_],actions:[y?T.actions:T.actionsSingleline,(l={display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",forcedColorAdjust:"auto",MsHighContrastAdjust:"auto"},l[P]={gridArea:"action",marginRight:8,marginBottom:8},l.selectors={"& button:nth-child(n+2)":(v={marginLeft:8},v[P]={marginBottom:0},v)},l),y&&{marginBottom:8},g&&!y&&{marginRight:0}]}}),void 0,{scope:"MessageBar"})},77291:function(e,t,r){var n;r.d(t,{f:function(){return n}}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(n||(n={}))}}]);
//# sourceMappingURL=cardloopcomponent-chunk.421f0169.chunk.js.map